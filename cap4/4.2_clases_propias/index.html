
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.1, mkdocs-material-8.5.6">
    
    
      
        <title>Modelar las entidades en código Swift - PDDM-iOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#generacion-automatica-de-las-clases" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="PDDM-iOS" class="md-header__button md-logo" aria-label="PDDM-iOS" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PDDM-iOS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Modelar las entidades en código Swift
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PDDM-iOS" class="md-nav__button md-logo" aria-label="PDDM-iOS" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    PDDM-iOS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Persistencia básica
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Persistencia básica" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Persistencia básica
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.0_introduccion/" class="md-nav__link">
        Introducción
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.1_sistema_de_archivos/" class="md-nav__link">
        Sistema de archivos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.2_serializacion/" class="md-nav__link">
        Serialización
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.3_property_lists/" class="md-nav__link">
        Property lists
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.4_preferencias/" class="md-nav__link">
        Preferencias
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          ¡Hola Core Data!. Una aplicación de ejemplo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="¡Hola Core Data!. Una aplicación de ejemplo" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          ¡Hola Core Data!. Una aplicación de ejemplo
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.1_intro/" class="md-nav__link">
        Introducción a Core Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.2_stack/" class="md-nav__link">
        Crear el stack de Core Data en iOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.3_entidades/" class="md-nav__link">
        Ejercicio parte I. almacenar datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.4_recuperar_datos/" class="md-nav__link">
        Ejercicio parte II. recuperar los datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/apendice_ver_almacenamiento/" class="md-nav__link">
        Apéndice. Cómo examinar el almacenamiento persistente
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Modelos de datos en Core Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Modelos de datos en Core Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Modelos de datos en Core Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.1_crear_modelo/" class="md-nav__link">
        Crear y editar modelos
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Modelar las entidades en código Swift
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Modelar las entidades en código Swift
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#generacion-automatica-de-las-clases" class="md-nav__link">
    Generación automática de las clases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generacion-manual-de-las-clases" class="md-nav__link">
    Generación manual de las clases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generacion-semi-automatica-de-las-clases" class="md-nav__link">
    Generación "semi-automática" de las clases
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.3_CRUD/" class="md-nav__link">
        CRUD en Core Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.4_validaciones/" class="md-nav__link">
        Validaciones
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.5_otros_tipos/" class="md-nav__link">
        Otros tipos de datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4.6_ejercicios/" class="md-nav__link">
        Ejercicios de modelos de datos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Búsquedas en Core Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Búsquedas en Core Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Búsquedas en Core Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap6/1_predicados/" class="md-nav__link">
        Predicados
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap6/2_ordenacion/" class="md-nav__link">
        Ordenación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap6/3_ejercicios/" class="md-nav__link">
        Ejercicios
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Tablas en Core Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tablas en Core Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Tablas en Core Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/1_el_frc/" class="md-nav__link">
        El "fetched results controller"
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/2_configuracion_basica/" class="md-nav__link">
        Inicializar el "fetched results controller"
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/3_tabla/" class="md-nav__link">
        Mostrar los datos en la tabla
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/4_refrescar_tabla/" class="md-nav__link">
        Refrescar la tabla
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/5_secciones/" class="md-nav__link">
        Secciones de tabla automáticas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/6_ejercicios/" class="md-nav__link">
        Ejercicios
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Miniproyecto
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Miniproyecto" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Miniproyecto
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miniproyecto/restaurante/" class="md-nav__link">
        Enunciado
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Migraciones de datos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Migraciones de datos" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Migraciones de datos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap8/1_intro/" class="md-nav__link">
        Qué son las migraciones de datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap8/2_versiones/" class="md-nav__link">
        Versiones del modelo de datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap8/3_migraciones_ligeras/" class="md-nav__link">
        Migraciones ligeras
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap8/4_migraciones_pesadas/" class="md-nav__link">
        Migraciones pesadas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap8/5_ejercicios/" class="md-nav__link">
        Ejercicios
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Concurrencia. Contextos múltiples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Concurrencia. Contextos múltiples" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Concurrencia. Contextos múltiples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap9/1_background/" class="md-nav__link">
        Múltiples contextos para trabajos en background
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap9/2_comunicacion/" class="md-nav__link">
        Comunicación entre contextos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap9/3_contextos_anidados/" class="md-nav__link">
        Contextos anidados
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap9/4_ejercicios/" class="md-nav__link">
        Ejercicio
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#generacion-automatica-de-las-clases" class="md-nav__link">
    Generación automática de las clases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generacion-manual-de-las-clases" class="md-nav__link">
    Generación manual de las clases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generacion-semi-automatica-de-las-clases" class="md-nav__link">
    Generación "semi-automática" de las clases
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Modelar las entidades en código Swift</h1>

<p>Desde el punto de vista del código Swift las entidades del modelo serán instancias de clases Swift. Así, dada la entidad Usuario con ciertos atributos lo que tendremos en Swift es una clase con el mismo nombre y las correspondientes propiedades.</p>
<h2 id="generacion-automatica-de-las-clases">Generación automática de las clases<a class="headerlink" href="#generacion-automatica-de-las-clases" title="Permanent link">&para;</a></h2>
<p>Las clases de nuestro modelo de datos se pueden generar automáticamente y de modo transparente para el desarrollador cada vez que guardemos el modelo de datos (el <code>.xcdatamodeld</code>). </p>
<p>En el editor del modelo de datos, si seleccionamos una entidad y accedemos a sus atributos en el panel de la derecha, veremos que hay una sección titulada <code>Class</code> que se ocupa del código generado, podemos cambiar:</p>
<ul>
<li>El nombre de la clase generada (por defecto el de la entidad)</li>
<li>El módulo de Swift donde se crea la clase (por defecto pone <code>Global Namespace</code>, lo que significa que no hará falta ningún <code>import</code> para referenciar la clase)</li>
<li>La estrategia de generación de código o <code>codegen</code>. Aquí por defecto aparece seleccionada la opción  <code>Class definition</code>, que indica que Xcode va a generar automáticamente todo el código asociado a la entidad. Con <code>Manual/None</code> habría que generar el código explícitamente. Con <code>Category/Extension</code> parte del código se generará automáticamente y parte de forma manual.</li>
</ul>
<p>Las clases se vuelven a generar si ha habido cambios cada vez que guardamos el modelo de datos (<code>File&gt;Save</code> o <code>Cmd-S</code>). No se generan en el directorio del proyecto, de modo que no son visibles directamente, sino en un directorio aparte denominado <code>Derived Data</code>, donde Xcode coloca típicamente el código auxiliar generado por él. Este directorio por defecto está en otro lugar totalmente distinto del proyecto, podemos ver dónde está en la opción <code>File&gt;Project Settings</code>, aunque no es necesario verlo ni recomendable modificar el contenido generado.</p>
<blockquote>
<p>Si queremos "echarle un vistazo" al fuente de las clases generadas sin tener que ir a la carpeta podemos usar el "truco" de hacer <code>Cmd-Click</code> sobre el nombre de una clase que tengamos en el código. Xcode abre automáticamente el archivo en el que se define. Esto funciona con las clases de nuestro proyecto, con las autogeneradas y almacenadas en <code>Derived Data</code> e incluso con clases del sistema, como por ejemplo <code>UIViewController</code>.</p>
</blockquote>
<p>Cuando una entidad tiene relaciones a uno o a muchos podemos manipular estas relaciones a través de propiedades y métodos de la clase generada. Veremos esto en la sección dedicada a CRUD.</p>
<h2 id="generacion-manual-de-las-clases">Generación manual de las clases<a class="headerlink" href="#generacion-manual-de-las-clases" title="Permanent link">&para;</a></h2>
<p>Desde la versión 8 de Xcode el modo "automático" es el activo por defecto. No obstante en algunos casos nos interesará personalizar el código generado por Xcode añadiendo métodos y/o propiedades, y para esto no podemos usar la generación automática, ya que por un lado el código no es directamente visible en el proyecto y por otro Xcode sobreescribiría los cambios hechos manualmente.</p>
<p>Xcode tiene un asistente que puede crear las clases que representan a las entidades. Teniendo seleccionada una entidad cualquiera en el  editor del modelo de datos, elegimos la opción <code>Editor &gt; Create NSManagedObject Subclass...</code> en el menú de Xcode. Se activará el asistente, que es bastante sencillo de usar. Solo tenemos que elegir el modelo de datos (si es que tenemos más de uno) y las entidades para las que vamos a generar clases.</p>
<p>Por cada entidad Xcode generará dos archivos:</p>
<ul>
<li>Una clase con el mismo nombre que la entidad (aunque el nombre se puede cambiar). Esta clase se declara como una subclase de <code>NSManagedObject</code>, que es la que proporciona la funcionalidad básica a las entidades</li>
<li>Una extensión Swift de esta clase. En ésta se definen las propiedades de la entidad y un conjunto de métodos que nos facilitarán el trabajo con las relaciones entre entidades.</li>
</ul>
<blockquote>
<p>IMPORTANTE: En este modo de funcionamiento, Xcode no mantiene automáticamente sincronizado el modelo de datos y el código Swift. Si tras generar las clases modificamos las entidades, tendremos que borrar las clases generadas y volver a generarlas</p>
</blockquote>
<p>Vamos a ver un ejemplo del tipo de código que genera Xcode. Si tuviéramos el modelo de datos de la figura</p>
<p><img alt="" src="../img/graph_datamodel_2.png" /></p>
<p>Tras generar clases para todas las entidades, acabaremos con 6 archivos fuente nuevos, dos por cada entidad. Para cada entidad, el primero de ellos tiene el mismo nombre que la entidad terminado en <code>+CoreDataClass.swift</code>. Si lo abrimos veremos que es la definición de una clase "vacía", marcada con algunas anotaciones especiales para que funcione correctamente la maquinaria interna de Core Data. Por ejemplo, para la entidad <code>Usuario</code> tendríamos algo como:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//  Usuario+CoreDataClass.swift</span>
<span class="kd">import</span> <span class="nc">Foundation</span>
<span class="kd">import</span> <span class="nc">CoreData</span>

<span class="kr">@objc</span><span class="p">(</span><span class="n">Usuario</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Usuario</span><span class="p">:</span> <span class="bp">NSManagedObject</span> <span class="p">{</span>

<span class="p">}</span>
</code></pre></div>
<p>El segundo de los archivos para cada entidad tiene un nombre terminado en <code>+CoreDataProperties.swift</code>. Este archivo contiene una extensión de la clase anterior. El código generado tiene dos partes diferenciadas.</p>
<p>En primer lugar tenemos <strong>la definición de las propiedades</strong>, que en el ejemplo serían algo como</p>
<div class="highlight"><pre><span></span><code><span class="kr">@NSManaged</span> <span class="kd">public</span> <span class="kd">var</span> <span class="nv">login</span><span class="p">:</span> <span class="nb">String</span><span class="p">?</span>
<span class="kr">@NSManaged</span> <span class="kd">public</span> <span class="kd">var</span> <span class="nv">creditos</span><span class="p">:</span> <span class="nb">Int16</span>
<span class="kr">@NSManaged</span> <span class="kd">public</span> <span class="kd">var</span> <span class="nv">password</span><span class="p">:</span> <span class="nb">String</span><span class="p">?</span>
<span class="kr">@NSManaged</span> <span class="kd">public</span> <span class="kd">var</span> <span class="nv">mensajes</span><span class="p">:</span> <span class="bp">NSSet</span><span class="p">?</span>
<span class="kr">@NSManaged</span> <span class="kd">public</span> <span class="kd">var</span> <span class="nv">conversaciones</span><span class="p">:</span> <span class="bp">NSOrderedSet</span><span class="p">?</span>
</code></pre></div>
<p>Nótese que en la definición de la clase tenemos no solo las propiedades de la entidad en sí sino también <strong>propiedades que representan las relaciones</strong>. Por ejemplo en el diagrama puede verse una relación uno a muchos entre <code>Usuario</code> y <code>Mensaje</code> llamada <code>mensajes</code>, que representaría los mensajes enviados por un usuario. Esta relación se representa en código con la propiedad del mismo nombre. Esto quiere decir que si tenemos un usuario y vamos imprimiendo los objetos contenidos en la propiedad <code>mensajes</code> en realidad estaremos accediendo a la entidad <code>Mensaje</code>. Esto es mucho más sencillo y "limpio" que andar haciendo JOINs en SQL para obtener los datos relacionados.</p>
<blockquote>
<p>Que las relaciones se vean en código como propiedades es lo que explica la convención de darle siempre a una relación el nombre de la entidad destino en singular si es "a uno" y en plural si es "a muchos", ya que en código queda bastante natural. Por ejemplo dado un usuario <code>u</code> sus mensajes serían accesibles como <code>u.mensajes</code>, y dado un mensaje <code>m</code> la conversación a la que pertenece estaría en <code>m.conversacion</code>. </p>
</blockquote>
<p>Nótese que las relaciones "uno a muchos" se modelan con <code>NSSet</code> si no son ordenadas. Con esta estructura de datos no se nos garantiza un orden determinado al ir iterando por ella. En el caso de ser una relación marcada como ordenada Xcode habría generado un <code>NSOrderedSet</code>.</p>
<p><code>NSSet</code> es el "equivalente" al  tipo <code>Set</code> de Swift, pero <code>NSSet</code> está definido en la librería <code>Foundation</code> y no en la librería estándar de Swift, ya que se desarrolló inicialmente para usarse en Objective C, que no tiene un tipo nativo para definir conjuntos. Hay que tener en cuenta que Core Data se desarrolló originalmente para Objective C, por lo que la infraestructura para implementarlo se ha "heredado" de éste.</p>
<p><code>NSSet</code> y <code>NSOrderedSet</code> complican un poco el trabajo cuando en lugar de simplemente leer datos queremos modificarlos (añadir un nuevo mensaje a una conversación, por ejemplo), ya que en Objective C se diferencia entre colecciones <em>mutables</em> e <em>inmutables</em>. En Swift lo que hace que una colección sea mutable o no es si la declaramos con <code>let</code> o con <code>var</code>, como en el resto de tipos, pero en <code>Foundation</code> cada colección tiene dos variantes, la "versión" mutable y la inmutable. Así , los <code>NSSet</code> son <em>inmutables</em>, de modo que no podríamos añadir más elementos a la relación usando directamente la variable. Tendríamos que obtener una copia <em>mutable</em> de la colección y trabajar con ella. Una posibilidad para hacer esto es llamar al método <code>mutableSetValueForKey</code> de <code>NSManagedObject</code>, que nos devolverá un conjunto mutable para una propiedad determinada.</p>
<p>Para facilitar el trabajo con las relaciones "a muchos" Xcode también <strong>genera métodos de acceso para las colecciones, o <em>accesores</em></strong>. Estos accesores nos permiten añadir/eliminar elementos de la colección. En el caso del <code>Usuario</code>, generará algo como:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// </span><span class="cs">MARK:</span><span class="c1"> Generated accessors for mensajes</span>
<span class="kd">extension</span> <span class="nc">Usuario</span> <span class="p">{</span>

    <span class="kr">@objc</span><span class="p">(</span><span class="n">addMensajesObject</span><span class="p">:)</span>
    <span class="kr">@NSManaged</span> <span class="kd">public</span> <span class="kd">func</span> <span class="nf">addToMensajes</span><span class="p">(</span><span class="kc">_</span> <span class="n">value</span><span class="p">:</span> <span class="n">Mensaje</span><span class="p">)</span>

    <span class="kr">@objc</span><span class="p">(</span><span class="n">removeMensajesObject</span><span class="p">:)</span>
    <span class="kr">@NSManaged</span> <span class="kd">public</span> <span class="kd">func</span> <span class="nf">removeFromMensajes</span><span class="p">(</span><span class="kc">_</span> <span class="n">value</span><span class="p">:</span> <span class="n">Mensaje</span><span class="p">)</span>

    <span class="kr">@objc</span><span class="p">(</span><span class="n">addMensajes</span><span class="p">:)</span>
    <span class="kr">@NSManaged</span> <span class="kd">public</span> <span class="kd">func</span> <span class="nf">addToMensajes</span><span class="p">(</span><span class="kc">_</span> <span class="n">values</span><span class="p">:</span> <span class="bp">NSSet</span><span class="p">)</span>

    <span class="kr">@objc</span><span class="p">(</span><span class="n">removeMensajes</span><span class="p">:)</span>
    <span class="kr">@NSManaged</span> <span class="kd">public</span> <span class="kd">func</span> <span class="nf">removeFromMensajes</span><span class="p">(</span><span class="kc">_</span> <span class="n">values</span><span class="p">:</span> <span class="bp">NSSet</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>De este modo en nuestro código podemos establecer una relación entre un determinado usuario y un determinado mensaje sin más que llamar al método <code>addToMensajes</code>. Por ejemplo podríamos hacer algo como:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//omitimos la parte en la que obtenemos una referencia al contexto de Core Data</span>
<span class="kd">let</span> <span class="nv">u</span> <span class="p">=</span> <span class="n">Usuario</span><span class="p">(</span><span class="n">context</span><span class="p">:</span><span class="n">miContexto</span><span class="p">)</span>
<span class="n">u</span><span class="p">.</span><span class="n">login</span> <span class="p">=</span> <span class="s">&quot;Pepe&quot;</span>
<span class="n">u</span><span class="p">.</span><span class="n">password</span> <span class="p">=</span> <span class="s">&quot;123456&quot;</span>
<span class="kd">let</span> <span class="nv">m</span> <span class="p">=</span> <span class="n">Mensaje</span><span class="p">(</span><span class="n">context</span><span class="p">:</span><span class="n">miContexto</span><span class="p">)</span>
<span class="n">u</span><span class="p">.</span><span class="n">addToMensajes</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="k">try</span><span class="p">!</span> <span class="n">miContexto</span><span class="p">.</span><span class="n">save</span><span class="p">()</span> 
</code></pre></div>
<h2 id="generacion-semi-automatica-de-las-clases">Generación "semi-automática" de las clases<a class="headerlink" href="#generacion-semi-automatica-de-las-clases" title="Permanent link">&para;</a></h2>
<p>En este modo se generaría automáticamente solo la extensión Swift donde se definen las propiedades y las relaciones, permitiendo que se mantenga una sincronización automática entre los atributos del modelo de datos y el código Swift. </p>
<p>Por otro lado la clase "principal" que hereda de <code>NSManagedObject</code> debemos generarla manualmente como en el apartado anterior, lo que nos permite añadir código propio a la clase (por ejemplo métodos de lógica de negocio o métodos auxiliares) sin problemas de que Xcode nos sobreescriba el código.</p>
<p>Este modo se elige en el editor del modelo de datos yendo a las propiedades de la entidad y seleccionando la opción <code>Category/Extension</code> del desplegable <code>Codegen</code>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Pie" >
      
        
        <a href="../4.1_crear_modelo/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Crear y editar modelos" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              Crear y editar modelos
            </div>
          </div>
        </a>
      
      
        
        <a href="../4.3_CRUD/" class="md-footer__link md-footer__link--next" aria-label="Siguiente: CRUD en Core Data" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Siguiente
              </span>
              CRUD en Core Data
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.078830c0.min.js"></script>
      
    
  </body>
</html>