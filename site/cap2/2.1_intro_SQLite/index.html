
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.2">
    
    
      
        <title>2.1 intro SQLite - PDDM-iOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.24c991ad.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduccion-a-sqlite-en-ios" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="PDDM-iOS" class="md-header__button md-logo" aria-label="PDDM-iOS" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PDDM-iOS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2.1 intro SQLite
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PDDM-iOS" class="md-nav__button md-logo" aria-label="PDDM-iOS" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    PDDM-iOS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Persistencia básica
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Persistencia básica" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Persistencia básica
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.0_introduccion/" class="md-nav__link">
        Introducción
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.1_sistema_de_archivos/" class="md-nav__link">
        Sistema de archivos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.2_serializacion/" class="md-nav__link">
        Serialización
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.3_property_lists/" class="md-nav__link">
        Property lists
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.4_preferencias/" class="md-nav__link">
        Preferencias
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion-a-sqlite-en-ios" class="md-nav__link">
    Introducción a SQLite en iOS
  </a>
  
    <nav class="md-nav" aria-label="Introducción a SQLite en iOS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configurar-el-proyecto" class="md-nav__link">
    Configurar el proyecto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incluir-la-base-de-datos-en-el-proyecto" class="md-nav__link">
    Incluir la base de datos en el proyecto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manejar-bases-de-datos-desde-la-consola" class="md-nav__link">
    Manejar bases de datos desde la consola
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>2.1 intro SQLite</h1>
                
                <h2 id="introduccion-a-sqlite-en-ios">Introducción a SQLite en iOS<a class="headerlink" href="#introduccion-a-sqlite-en-ios" title="Permanent link">&para;</a></h2>
<p>En iOS no hay ningún <em>framework</em> estándar para trabajar con SQLite de forma nativa. Lo más habitual es usar directamente el <a href="http://www.sqlite.org/c3ref/intro.html">API C de la librería</a>. Al ser C un subconjunto de Objective-C (e interoperable con Swift) usar este API no es mayor problema, salvo por el “engorro” de tener que emplear funcionalidades de bajo nivel y tipos de datos de C (<code>char *</code> en lugar de <code>String</code>, por ejemplo).</p>
<p>Como vamos a ver, el API es considerablemente de nivel más bajo que los que habéis usado en Android. Es muy improbable que en el futuro aparezca en iOS un API SQLite de nivel más alto, ya que Apple recomienda el uso del <em>framework</em> "Core data" sobre el uso directo de SQLite (como veremos, Core Data usa habitualmente SQLite de modo interno). No obstante, para casos de uso relativamente sencillos SQLite va a ser una alternativa mucho más ligera en recursos que Core Data. Además SQLite supone una barrera de entrada bastante baja para cualquier desarrollador habituado a trabajar con SQL y bases de datos, cosa que no se puede decir de Core Data.</p>
<h3 id="configurar-el-proyecto">Configurar el proyecto<a class="headerlink" href="#configurar-el-proyecto" title="Permanent link">&para;</a></h3>
<p>Para poder usar SQLite en un proyecto iOS primero hay que <strong>añadir manualmente la librería</strong>, no se añade automáticamente al contrario que otros <em>frameworks</em>. Seleccionamos el icono del proyecto (el azul) y en las propiedades del proyecto, opción <code>General</code>, al final de las opciones en <code>Linked frameworks and libraries</code>, (Xcode&lt;11) o <code>Frameworks, Libraries and Embedded Content</code>  (Xcode&gt;=11) pulsar sobre <code>+</code> y añadir <code>libsqlite3.tdb</code>.</p>
<p><img alt="" src="../img/add_libsqlite.gif" /></p>
<p>Para poder usar código C en un proyecto Swift necesitamos crear un archivo especial con los <code>include</code> necesarios. Esto es lo que se llama un <em>bridging header</em>.</p>
<p>Para <strong>crear el <em>bridging header</em></strong> vamos en Xcode a <code>File &gt; New &gt; File...</code> y en las plantillas seleccionamos "header file". Le damos cualquier nombre, por ejemplo <code>b-h.h</code>. El contenido de la plantilla que crea Xcode no nos sirve, debemos borrarlo y sustituirlo simplemente por esto:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sqlite3.h&gt;</span><span class="cp"></span>
</code></pre></div>
<p>Ahora debemos decirle a Xcode que este <code>.h</code> es efectivamente un <em>bridging header</em>. Para eso seleccionamos el icono del proyecto (el azul) y en el apartado <code>build settings</code> seleccionamos <code>All</code> y en el cuadro de búsqueda buscamos "bridging header". Aparecerá una opción llamada <code>Objective-C Bridging Header</code>, que estará vacía, y en la que debemos escribir el nombre de nuestro <code>b-h.h</code> (si lo has metido en una carpeta dentro del proyecto tendrás que poner delante su nombre)</p>
<p><img alt="" src="../img/bridging-header.gif" /></p>
<blockquote>
<p>Este proceso es mucho más simple cuando importamos directamente código C u Obj-C a nuestro proyecto, ya que al añadir el <code>.c</code> o <code>.m</code> Xcode lo detecta y crea y configura el <em>bridging header</em> automáticamente. No es este el caso, ya que aquí estamos usando una librería ya compilada. </p>
</blockquote>
<h3 id="incluir-la-base-de-datos-en-el-proyecto">Incluir la base de datos en el proyecto<a class="headerlink" href="#incluir-la-base-de-datos-en-el-proyecto" title="Permanent link">&para;</a></h3>
<p>La forma más típica de incluir la base de datos en el proyecto es copiarla al <em>bundle</em> de la aplicación. </p>
<blockquote>
<p><strong>No arrastres</strong> el archivo desde el <em>finder</em> hasta la ventana de Xcode. Se copiará en el directorio del proyecto pero no en el <em>bundle</em> de la aplicación</p>
</blockquote>
<p>Pulsa con el botón derecho sobre el proyecto y selecciona la opción de <code>Add files to "(nombre_del_proyecto)"</code>. En el cuadro de diálogo que aparecerá, seleccionar el archivo con la base de datos, pulsar sobre el botón <code>Options</code> y <strong>asegurarse de que está marcada la casilla <code>Copy items if needed</code></strong>, para hacer una copia en el directorio del proyecto y no usar simplemente una referencia al archivo original.</p>
<h3 id="manejar-bases-de-datos-desde-la-consola">Manejar bases de datos desde la consola<a class="headerlink" href="#manejar-bases-de-datos-desde-la-consola" title="Permanent link">&para;</a></h3>
<p>Aunque en el Mac no hay ninguna herramienta gráfica por defecto para gestionar bases de datos SQLite sí hay preinstalada una herramienta en línea de comandos: <code>sqlite3</code>. </p>
<p>Para abrir una base de datos, desde la terminal: </p>
<div class="highlight"><pre><span></span><code>sqlite3 nombre_bd
</code></pre></div>
<p>Se abrirá un <em>prompt</em> donde podemos usar varios comandos, por ejemplo:</p>
<ul>
<li><code>.tables</code>, para listar tablas</li>
<li><code>.schema nombre_de_tabla</code> para ver estructura de una tabla</li>
<li>Se pueden teclear directamente sentencias SQL, terminándolas en `;``</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "../../assets/javascripts/workers/search.e99e714c.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.bc35569b.min.js"></script>
      
    
  </body>
</html>