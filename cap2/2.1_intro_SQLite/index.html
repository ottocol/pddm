



<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>2.1 intro SQLite - PDDM-iOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#introduccion-a-sqlite-en-ios" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="PDDM-iOS" class="md-header-nav__button md-logo">
          
            <img src="../../logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              PDDM-iOS
            </span>
            <span class="md-header-nav__topic">
              
                2.1 intro SQLite
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="PDDM-iOS" class="md-nav__button md-logo">
      
        <img src="../../logo.png" width="48" height="48">
      
    </a>
    PDDM-iOS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Persistencia básica
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Persistencia básica
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap1/1.1_sistema_de_archivos/" title="Sistema de archivos" class="md-nav__link">
      Sistema de archivos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap1/1.2_serializacion/" title="Serialización" class="md-nav__link">
      Serialización
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap1/1.3_property_lists/" title="Property lists" class="md-nav__link">
      Property lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap1/1.4_preferencias/" title="Preferencias" class="md-nav__link">
      Preferencias
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap1/1.5_ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion-a-sqlite-en-ios" class="md-nav__link">
    Introducción a SQLite en iOS
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configurar-el-proyecto" class="md-nav__link">
    Configurar el proyecto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incluir-la-base-de-datos-en-el-proyecto" class="md-nav__link">
    Incluir la base de datos en el proyecto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manejar-bases-de-datos-desde-la-consola" class="md-nav__link">
    Manejar bases de datos desde la consola
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>2.1 intro SQLite</h1>
                
                <h2 id="introduccion-a-sqlite-en-ios">Introducción a SQLite en iOS<a class="headerlink" href="#introduccion-a-sqlite-en-ios" title="Permanent link">&para;</a></h2>
<p>En iOS no hay ningún <em>framework</em> estándar para trabajar con SQLite de forma nativa. Lo más habitual es usar directamente el <a href="http://www.sqlite.org/c3ref/intro.html">API C de la librería</a>. Al ser C un subconjunto de Objective-C (e interoperable con Swift) usar este API no es mayor problema, salvo por el “engorro” de tener que emplear funcionalidades de bajo nivel y tipos de datos de C (<code>char *</code> en lugar de <code>String</code>, por ejemplo).</p>
<p>Como vamos a ver, el API es considerablemente de nivel más bajo que los que habéis usado en Android. Es muy improbable que en el futuro aparezca en iOS un API SQLite de nivel más alto, ya que Apple recomienda el uso del <em>framework</em> "Core data" sobre el uso directo de SQLite (como veremos, Core Data usa habitualmente SQLite de modo interno). No obstante, para casos de uso relativamente sencillos SQLite va a ser una alternativa mucho más ligera en recursos que Core Data. Además SQLite supone una barrera de entrada bastante baja para cualquier desarrollador habituado a trabajar con SQL y bases de datos, cosa que no se puede decir de Core Data.</p>
<h3 id="configurar-el-proyecto">Configurar el proyecto<a class="headerlink" href="#configurar-el-proyecto" title="Permanent link">&para;</a></h3>
<p>Para poder usar SQLite en un proyecto iOS primero hay que <strong>añadir manualmente la librería</strong>, no se añade automáticamente al contrario que otros <em>frameworks</em>. Seleccionamos el icono del proyecto (el azul) y en las propiedades del proyecto, opción <code>General</code>, al final de las opciones en <code>Linked frameworks and libraries</code>, (Xcode&lt;11) o <code>Frameworks, Libraries and Embedded Content</code>  (Xcode&gt;=11) pulsar sobre <code>+</code> y añadir <code>libsqlite3.tdb</code>.</p>
<p><img alt="" src="../img/add_libsqlite.gif" /></p>
<p>Para poder usar código C en un proyecto Swift necesitamos crear un archivo especial con los <code>include</code> necesarios. Esto es lo que se llama un <em>bridging header</em>.</p>
<p>Para <strong>crear el *bridging header</strong>* vamos en Xcode a <code>File &gt; New &gt; File...</code> y en las plantillas seleccionamos "header file". Le damos cualquier nombre, por ejemplo <code>b-h.h</code>. El contenido de la plantilla que crea Xcode no nos sirve, debemos borrarlo y sustituirlo simplemente por esto:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;sqlite3.h&gt;</span><span class="cp"></span>
</pre></div>
</td></tr></table>

<p>Ahora debemos decirle a Xcode que este <code>.h</code> es efectivamente un <em>bridging header</em>. Para eso seleccionamos el icono del proyecto (el azul) y en el apartado <code>build settings</code> seleccionamos <code>All</code> y en el cuadro de búsqueda buscamos "bridging header". Aparecerá una opción llamada <code>Objective-C Bridging Header</code>, que estará vacía, y en la que debemos escribir el nombre de nuestro <code>b-h.h</code> (si lo has metido en una carpeta dentro del proyecto tendrás que poner delante su nombre)</p>
<p><img alt="" src="../img/bridging-header.gif" /></p>
<blockquote>
<p>Este proceso es mucho más simple cuando importamos directamente código C u Obj-C a nuestro proyecto, ya que al añadir el <code>.c</code> o <code>.m</code> Xcode lo detecta y crea y configura el <em>bridging header</em> automáticamente. No es este el caso, ya que aquí estamos usando una librería ya compilada. </p>
</blockquote>
<h3 id="incluir-la-base-de-datos-en-el-proyecto">Incluir la base de datos en el proyecto<a class="headerlink" href="#incluir-la-base-de-datos-en-el-proyecto" title="Permanent link">&para;</a></h3>
<p>La forma más típica de incluir la base de datos en el proyecto es copiarla al <em>bundle</em> de la aplicación. </p>
<blockquote>
<p><strong>No arrastres</strong> el archivo desde el <em>finder</em> hasta la ventana de Xcode. Se copiará en el directorio del proyecto pero no en el <em>bundle</em> de la aplicación</p>
</blockquote>
<p>Pulsa con el botón derecho sobre el proyecto y selecciona la opción de <code>Add files to "(nombre_del_proyecto)"</code>. En el cuadro de diálogo que aparecerá, seleccionar el archivo con la base de datos, pulsar sobre el botón <code>Options</code> y <strong>asegurarse de que está marcada la casilla <code>Copy items if needed</code></strong>, para hacer una copia en el directorio del proyecto y no usar simplemente una referencia al archivo original.</p>
<h3 id="manejar-bases-de-datos-desde-la-consola">Manejar bases de datos desde la consola<a class="headerlink" href="#manejar-bases-de-datos-desde-la-consola" title="Permanent link">&para;</a></h3>
<p>Aunque en el Mac no hay ninguna herramienta gráfica por defecto para gestionar bases de datos SQLite sí hay preinstalada una herramienta en línea de comandos: <code>sqlite3</code>. </p>
<p>Para abrir una base de datos, desde la terminal: </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sqlite3 nombre_bd
</pre></div>
</td></tr></table>

<p>Se abrirá un <em>prompt</em> donde podemos usar varios comandos, por ejemplo:</p>
<ul>
<li><code>.tables</code>, para listar tablas</li>
<li><code>.schema nombre_de_tabla</code> para ver estructura de una tabla</li>
<li>Se pueden teclear directamente sentencias SQL, terminándolas en `;``</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>