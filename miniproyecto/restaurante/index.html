
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.1, mkdocs-material-8.5.6">
    
    
      
        <title>Enunciado - PDDM-iOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#miniproyecto-app-restaurante-25-puntos-en-total" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="PDDM-iOS" class="md-header__button md-logo" aria-label="PDDM-iOS" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PDDM-iOS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Enunciado
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PDDM-iOS" class="md-nav__button md-logo" aria-label="PDDM-iOS" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    PDDM-iOS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Persistencia básica
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Persistencia básica" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Persistencia básica
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.0_introduccion/" class="md-nav__link">
        Introducción
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.1_sistema_de_archivos/" class="md-nav__link">
        Sistema de archivos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.2_serializacion/" class="md-nav__link">
        Serialización
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.3_property_lists/" class="md-nav__link">
        Property lists
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap1/1.4_preferencias/" class="md-nav__link">
        Preferencias
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          ¡Hola Core Data!. Una aplicación de ejemplo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="¡Hola Core Data!. Una aplicación de ejemplo" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          ¡Hola Core Data!. Una aplicación de ejemplo
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.1_intro/" class="md-nav__link">
        Introducción a Core Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.2_stack/" class="md-nav__link">
        Crear el stack de Core Data en iOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.3_entidades/" class="md-nav__link">
        Ejercicio parte I. almacenar datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.4_recuperar_datos/" class="md-nav__link">
        Ejercicio parte II. recuperar los datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/apendice_ver_almacenamiento/" class="md-nav__link">
        Apéndice. Cómo examinar el almacenamiento persistente
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Modelos de datos en Core Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Modelos de datos en Core Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Modelos de datos en Core Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.1_crear_modelo/" class="md-nav__link">
        Crear y editar modelos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.2_clases_propias/" class="md-nav__link">
        Modelar las entidades en código Swift
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.3_CRUD/" class="md-nav__link">
        CRUD en Core Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.4_validaciones/" class="md-nav__link">
        Validaciones
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.5_otros_tipos/" class="md-nav__link">
        Otros tipos de datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.6_ejercicios/" class="md-nav__link">
        Ejercicios de modelos de datos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Búsquedas en Core Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Búsquedas en Core Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Búsquedas en Core Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap6/1_predicados/" class="md-nav__link">
        Predicados
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap6/2_ordenacion/" class="md-nav__link">
        Ordenación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap6/3_ejercicios/" class="md-nav__link">
        Ejercicios
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Tablas en Core Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tablas en Core Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Tablas en Core Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/1_el_frc/" class="md-nav__link">
        El "fetched results controller"
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/2_configuracion_basica/" class="md-nav__link">
        Inicializar el "fetched results controller"
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/3_tabla/" class="md-nav__link">
        Mostrar los datos en la tabla
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/4_refrescar_tabla/" class="md-nav__link">
        Refrescar la tabla
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/5_secciones/" class="md-nav__link">
        Secciones de tabla automáticas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/6_ejercicios/" class="md-nav__link">
        Ejercicios
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Miniproyecto
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Miniproyecto" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Miniproyecto
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Enunciado
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Enunciado
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#el-modelo-de-datos-05-puntos" class="md-nav__link">
    El modelo de datos (0,5 puntos)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inicializar-los-datos-025-puntos" class="md-nav__link">
    Inicializar los datos (0,25 puntos)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funcionalidad-la-carta-05-puntos" class="md-nav__link">
    Funcionalidad: La Carta (0,5 puntos)
  </a>
  
    <nav class="md-nav" aria-label="Funcionalidad: La Carta (0,5 puntos)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listado-de-platos" class="md-nav__link">
    Listado de platos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#busquedafiltrado-de-platos" class="md-nav__link">
    Búsqueda/Filtrado de platos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anadir-al-pedido-actual" class="md-nav__link">
    Añadir al pedido actual
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funcionalidad-el-pedido-actual-075-puntos" class="md-nav__link">
    Funcionalidad: El pedido actual (0,75 puntos)
  </a>
  
    <nav class="md-nav" aria-label="Funcionalidad: El pedido actual (0,75 puntos)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anadir-el-plato-elegido-al-pedido" class="md-nav__link">
    Añadir el plato elegido al pedido
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listar-los-platos-del-pedido" class="md-nav__link">
    Listar los platos del pedido
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cambiar-la-cantidad-de-un-plato" class="md-nav__link">
    Cambiar la cantidad de un plato
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#realizar-y-cancelar-pedido" class="md-nav__link">
    Realizar y cancelar pedido
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#el-boton-tu-pedido-del-tab-bar" class="md-nav__link">
    El botón "Tu pedido" del tab bar
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funcionalidad-tu-historial-hasta-05-puntos" class="md-nav__link">
    Funcionalidad: Tu historial (hasta 0,5 puntos)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apendice-diagrama-uml-de-las-clases-del-proyecto" class="md-nav__link">
    Apéndice: diagrama UML de las clases del proyecto
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Migraciones de datos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Migraciones de datos" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Migraciones de datos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap8/1_intro/" class="md-nav__link">
        Qué son las migraciones de datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap8/2_versiones/" class="md-nav__link">
        Versiones del modelo de datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap8/3_migraciones_ligeras/" class="md-nav__link">
        Migraciones ligeras
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap8/4_migraciones_pesadas/" class="md-nav__link">
        Migraciones pesadas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap8/5_ejercicios/" class="md-nav__link">
        Ejercicios
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Concurrencia. Contextos múltiples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Concurrencia. Contextos múltiples" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Concurrencia. Contextos múltiples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap9/1_background/" class="md-nav__link">
        Múltiples contextos para trabajos en background
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap9/2_comunicacion/" class="md-nav__link">
        Comunicación entre contextos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap9/3_contextos_anidados/" class="md-nav__link">
        Contextos anidados
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap9/4_ejercicios/" class="md-nav__link">
        Ejercicio
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#el-modelo-de-datos-05-puntos" class="md-nav__link">
    El modelo de datos (0,5 puntos)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inicializar-los-datos-025-puntos" class="md-nav__link">
    Inicializar los datos (0,25 puntos)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funcionalidad-la-carta-05-puntos" class="md-nav__link">
    Funcionalidad: La Carta (0,5 puntos)
  </a>
  
    <nav class="md-nav" aria-label="Funcionalidad: La Carta (0,5 puntos)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listado-de-platos" class="md-nav__link">
    Listado de platos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#busquedafiltrado-de-platos" class="md-nav__link">
    Búsqueda/Filtrado de platos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anadir-al-pedido-actual" class="md-nav__link">
    Añadir al pedido actual
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funcionalidad-el-pedido-actual-075-puntos" class="md-nav__link">
    Funcionalidad: El pedido actual (0,75 puntos)
  </a>
  
    <nav class="md-nav" aria-label="Funcionalidad: El pedido actual (0,75 puntos)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anadir-el-plato-elegido-al-pedido" class="md-nav__link">
    Añadir el plato elegido al pedido
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listar-los-platos-del-pedido" class="md-nav__link">
    Listar los platos del pedido
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cambiar-la-cantidad-de-un-plato" class="md-nav__link">
    Cambiar la cantidad de un plato
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#realizar-y-cancelar-pedido" class="md-nav__link">
    Realizar y cancelar pedido
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#el-boton-tu-pedido-del-tab-bar" class="md-nav__link">
    El botón "Tu pedido" del tab bar
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funcionalidad-tu-historial-hasta-05-puntos" class="md-nav__link">
    Funcionalidad: Tu historial (hasta 0,5 puntos)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apendice-diagrama-uml-de-las-clases-del-proyecto" class="md-nav__link">
    Apéndice: diagrama UML de las clases del proyecto
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="miniproyecto-app-restaurante-25-puntos-en-total">Miniproyecto: <em>app</em> restaurante (2,5 puntos en total)<a class="headerlink" href="#miniproyecto-app-restaurante-25-puntos-en-total" title="Permanent link">&para;</a></h1>
<p>El objetivo es desarrollar una pequeña aplicación para gestionar pedidos <em>online</em> a un restaurante. Para ello almacenaremos los datos de la carta y de los pedidos realizados por el usuario en Core Data.</p>
<p>Descárgate la plantilla de la aplicación desde moodle, aquí está ya implementada la mayor parte de la interfaz.</p>
<p>Inicialmente nos ocuparemos del modelo de datos y de leer los datos de los platos, que están almacenados en un JSON, y pasarlos a Core Data. Una vez hecho esto nos pondremos a implementar las funcionalidades de la aplicación.</p>
<h2 id="el-modelo-de-datos-05-puntos">El modelo de datos (0,5 puntos)<a class="headerlink" href="#el-modelo-de-datos-05-puntos" title="Permanent link">&para;</a></h2>
<p><strong>En el proyecto abre el fichero <code>Restaurante.xcdatamodeld</code> y crea el siguiente modelo de datos</strong></p>
<p>Nuestro modelo de datos debe tener tres entidades, <code>Plato</code>, <code>Pedido</code> y <code>LineaPedido</code>. Esta última es la que relaciona los platos con los pedidos,  guardando cuántas unidades de un plato se han incluido en un pedido. </p>
<blockquote>
<p>En la figura, las flechas dobles representan relaciones "a muchos" y las flechas simples "a uno"</p>
</blockquote>
<p><img alt="" src="../modelo_datos.png" /></p>
<div class="admonition info">
<p class="admonition-title">Consejos</p>
<ul>
<li>Crea primero todas las entidades y después las relaciones, si no no podrás especificar la entidad destino de cada relación</li>
<li>Las relaciones por defecto se crean "<em>de uno a uno</em>" y sin orden, recuerda modificar esto en el panel derecho de Xcode si es necesario</li>
</ul>
</div>
<p>Cada entidad debe tener las siguientes propiedades y relaciones</p>
<ul>
<li><code>Plato</code>:<ul>
<li>Propiedades:<ul>
<li><code>nombre</code> de tipo <code>String</code></li>
<li><code>descripcion</code> de tipo <code>String</code></li>
<li><code>precio</code> de tipo <code>Double</code></li>
<li><code>tipo</code> de tipo <code>String</code></li>
</ul>
</li>
<li>Relaciones:<ul>
<li><code>lineasPedido</code>, relación "a muchos" con destino <code>LineaPedido</code>. La inversa es la relación <code>plato</code></li>
</ul>
</li>
</ul>
</li>
<li><code>Pedido</code>:<ul>
<li>Propiedades:<ul>
<li><code>direccion</code> de tipo <code>String</code></li>
<li><code>fecha</code> de tipo <code>Date</code></li>
<li><code>telefono</code> de tipo <code>String</code></li>
</ul>
</li>
<li>Relaciones:<ul>
<li><code>lineasPedido</code>, relación "a muchos" con destino <code>LineaPedido</code>. La relación <strong>debe ser ordenada</strong>, para poder mostrar las lineas de un pedido siempre en el mismo orden. La inversa es la relación <code>pedido</code>. En la regla de borrado (<code>delete rule</code>) pon <code>Cascade</code> para que al eliminar un pedido se eliminen automáticamente sus líneas.</li>
</ul>
</li>
</ul>
</li>
<li><code>LineaPedido</code>:<ul>
<li>Propiedades<ul>
<li><code>cantidad</code> de tipo <code>Integer 16</code></li>
</ul>
</li>
<li>Relaciones<ul>
<li><code>pedido</code>, relación "a uno" con destino <code>Pedido</code>. La inversa es la relación <code>lineasPedido</code></li>
<li><code>plato</code>, relación "a uno" con destino <code>Plato</code>. La inversa es la relación <code>lineasPedido</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Simplificaciones</p>
<p>Deberíamos usar tipos <code>Decimal</code> en los precios para evitar errores de redondeo, pero usaremos <code>Double</code> por simplicidad, ya que <code>Decimal</code> no se acepta directamente en Core Data y tendríamos que usar un <em>transformable</em>. Además, el tipo del plato debería ser un enumerado, pero estos tampoco se pueden almacenar directamente en Core Data.</p>
</div>
<h2 id="inicializar-los-datos-025-puntos">Inicializar los datos (0,25 puntos)<a class="headerlink" href="#inicializar-los-datos-025-puntos" title="Permanent link">&para;</a></h2>
<p>Un problema habitual en Core Data es cómo rellenar inicialmente la base de datos. Un enfoque muy habitual es incluir en el proyecto un archivo con los datos en algún formato estándar (JSON, CSV, YAML,..) y copiarlos a Core Data la primera vez que se ejeuta la app. Es lo que haremos aquí.</p>
<p>Los datos de los platos del restaurante están en un archivo <code>platos.json</code>.  En el <code>AppDelegate</code> hay una función <code>importPlatos</code> que lee el JSON, lo almacena en un array de <code>structs</code> de tipo <code>DatosPlato</code> con los datos correspondientes, y pone una preferencia de usuario llamada <code>platosImportados</code> a <code>true</code>. El JSON solo se lee si la preferencia está a <code>false</code> (valor por defecto)</p>
<p><strong>Añade código Swift que copie los datos de los structs <code>DatosPlato</code> a entidades <code>Plato</code> y guarde el contexto de persistencia para hacer efectivos los cambios</strong>. Tendrás que introducir el código en el <code>AppDelegate</code>, línea 34, donde está el comentario de <code>//TODO: copiar los datos</code>. El array de structs de tipo <code>DatosPlato</code> se llama <code>datos</code>. Recórrelo y copia todos sus datos a Core Data. Las propiedades de <code>DatosPlato</code> tienen los mismos nombres y tipos que en la entidad <code>Plato</code>.</p>
<p>Tras esto, con la ayuda de la aplicación <a href="https://github.com/dsmelov/simsim/blob/master/Release/SimSim_latest.zip?raw=true"><code>SimSim</code></a> puedes echarle un vistazo a la base de datos de SQLite creada por Core Data para ver si están los registros. En <code>SimSim</code> selecciona la app <code>Restaurante</code> y luego la opción <code>Terminal</code> para abrir una terminal en la carpeta de la <em>app</em> en el emulador. Para ver a base de datos SQLite puedes hacer en esta terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="s2">&quot;Library/Application Support&quot;</span>
sqlite3 Restaurante.sqlite
<span class="c1">##Debería aparecer el prompt de sqlite -&gt; &quot;sqlite&gt;&quot;</span>
<span class="c1">##Con esta orden puedes ver la estructura de la BD</span>
.schema
<span class="c1">##Las tablas tendrán el mismo nombre que las entidades de Core Data con una &quot;Z&quot; delante</span>
<span class="c1">##Por tanto puedes ver los platos con</span>
<span class="k">select</span> * from ZPLATO<span class="p">;</span>
<span class="c1">##Puedes salir de sqlite con Ctrl-Z, o cerrar la terminal, ya no te hace falta </span>
</code></pre></div>
<p>Para forzar la recarga de los datos puedes usar también la aplicación <code>SimSim</code> . Tendrás que borrar las preferencias y la base de datos. Puedes borrarlo todo automáticamente con la opción <code>Reset Application Data</code>. Si quieres borrarlo a mano, las preferencias están en <code>Library/Preferences</code> y recuerda que la BD está en <code>Library/Application Support</code>.</p>
<p>A partir de ahora implementaremos las funcionalidades de la <em>app</em>. La mayor parte de la interfaz ya está creada (salvo la última pantalla), tú tienes que implementar las funcionalidades relacionadas con Core Data.</p>
<h2 id="funcionalidad-la-carta-05-puntos">Funcionalidad: La Carta (0,5 puntos)<a class="headerlink" href="#funcionalidad-la-carta-05-puntos" title="Permanent link">&para;</a></h2>
<p>Esta parte de la <em>app</em> es la que muestra los platos y nos permite añadirlos al pedido.</p>
<p>En la pantalla de "Carta" se deben mostrar los datos de los platos. Está controlada por el <code>PlatosViewController</code>. Iremos primero con que salgan los platos listados y luego con la funcionalidad del botón de "Añadir" al pedido.</p>
<h3 id="listado-de-platos">Listado de platos<a class="headerlink" href="#listado-de-platos" title="Permanent link">&para;</a></h3>
<p>Usa un <code>NSFetchedResultsController</code> para <strong>listar los platos</strong> en la tabla. Haz que los platos se agrupen en secciones según su tipo.</p>
<ul>
<li>Declara e inicializa el <code>NSFetchedResultsController</code> en el <code>PlatosViewController</code>.  Es como los de la sesión anterior con la diferencia de que no debería usar una cache (pasar el parámetro <code>cacheName</code> a <code>nil</code>) , ya que al escribir en la barra de búsqueda cambiamos la <em>fetch request</em> y por tanto invalidamos la cache, por lo que en este caso no tiene utilidad.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Ayuda</p>
<p>Para lo anterior, puedes usar como guía el código de ejemplo del apartado <em><a href="../../cap7/2_configuracion_basica/">"inicializar el Fetched Results Controller"</a></em>. Pero con diferencias, algunas evidentes:</p>
<ul>
<li>Recuerda poner el nombre de cache a <code>nil</code> </li>
<li>La entidad es <code>Plato</code> en lugar de <code>Mensaje</code></li>
<li>Hay que ordenar por "tipo" en vez de por "fecha"</li>
<li>Hay que crear secciones automáticas basándose en el tipo (mira el apartado <a href="../../cap7/5_secciones/"><em>"secciones de tabla automáticas "</em></a>)</li>
</ul>
</div>
<ul>
<li>Rellena el código de los métodos que devuelven el número de secciones, de filas en cada sección y que devuelven las celdas rellenadas de la tabla. Estas celdas son de la clase <code>PlatoTableViewCell</code>, si miras la clase verás que ya tiene definidos <em>outlets</em> para poder rellenar los datos (son tres <em>labels</em>: <code>nombreLabel</code>, <code>descripcionLabel</code> y <code>precioLabel</code>)</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Ayuda</p>
<p>Para lo anterior, puedes usar como guía el código de ejemplo del apartado <em><a href="../../cap7/3_tabla/">"Mostrar los datos en la tabla"</a></em>. Para saber cómo obtener el título de cada sección de la tabla consulta el apartado <a href="../../cap7/5_secciones/">"Secciones de tabla automáticas"</a> </p>
</div>
<p>Al terminar este apartado debería salir la lista de platos de la carta en la primera pantalla de la app. Todavía no funcionará el botón "Añadir" de cada plato ni se podrán filtrar platos.</p>
<h3 id="busquedafiltrado-de-platos">Búsqueda/Filtrado de platos<a class="headerlink" href="#busquedafiltrado-de-platos" title="Permanent link">&para;</a></h3>
<p>Implementa una <strong>búsqueda/filtrado de platos</strong> como hiciste en la aplicación de notas, que busque texto en el nombre o en la descripción del plato. Para aplicar el "filtro":</p>
<p>Declara un <code>UISearchController</code> en el <code>PlatosViewController</code> </p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span> <span class="nv">searchController</span> <span class="p">:</span> <span class="bp">UISearchController</span><span class="p">!</span>
</code></pre></div>
<p>e inicialízalo en el <code>viewDidLoad</code></p>
<div class="highlight"><pre><span></span><code><span class="kc">self</span><span class="p">.</span><span class="n">searchController</span> <span class="p">=</span> <span class="bp">UISearchController</span><span class="p">(</span><span class="n">searchResultsController</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre></div>
<p>Añade <code>UISearchResultsUpdating</code> a la cabecera del controller para que se ocupe de los resultados de la búsqueda, debe quedar como:</p>
<div class="highlight"><pre><span></span><code><span class="kd">class</span> <span class="nc">PlatosViewController</span><span class="p">:</span> <span class="bp">UIViewController</span><span class="p">,</span> <span class="bp">UITableViewDataSource</span><span class="p">,</span> <span class="n">PlatoTableViewCellDelegate</span><span class="p">,</span> <span class="bp">UISearchResultsUpdating</span>  <span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Xcode</p>
<p>Al añadir el <code>UISearchResultsUpdating</code> Xcode se "quejará"" de que falta implementar el método <code>updateSearchResults</code>. Lo haremos en un momento. </p>
</div>
<p>Configura el <em>search controller</em> y añádelo a la tabla en el <code>viewDidLoad</code>
<div class="highlight"><pre><span></span><code><span class="kc">self</span><span class="p">.</span><span class="n">searchController</span><span class="p">.</span><span class="n">searchResultsUpdater</span> <span class="p">=</span> <span class="kc">self</span>
<span class="c1">//Configuramos el search controller</span>
<span class="kc">self</span><span class="p">.</span><span class="n">searchController</span><span class="p">.</span><span class="n">obscuresBackgroundDuringPresentation</span> <span class="p">=</span> <span class="kc">false</span>
<span class="kc">self</span><span class="p">.</span><span class="n">searchController</span><span class="p">.</span><span class="n">searchBar</span><span class="p">.</span><span class="n">placeholder</span> <span class="p">=</span> <span class="s">&quot;Buscar texto&quot;</span>
<span class="c1">//Lo añadimos a la tabla</span>
<span class="kc">self</span><span class="p">.</span><span class="n">searchController</span><span class="p">.</span><span class="n">searchBar</span><span class="p">.</span><span class="n">sizeToFit</span><span class="p">()</span>
<span class="kc">self</span><span class="p">.</span><span class="n">tabla</span><span class="p">.</span><span class="n">tableHeaderView</span> <span class="p">=</span> <span class="n">searchController</span><span class="p">.</span><span class="n">searchBar</span>
</code></pre></div></p>
<p>Opcionalmente puedes usar un <a href="../Throttler.swift">Throttler</a> para que no busque en cada pulsación de tecla, sino que espere una fracción de segundo. En caso de que quieras usarlo, bájate el código del enlace anterior, ponlo en un archivo en tu proyecto y define en el <em>controller</em> una variable de la clase <code>Throttler</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nv">throttler</span> <span class="p">=</span> <span class="n">Throttler</span><span class="p">(</span><span class="n">minimumDelay</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
<p>Añade el método <code>updateSearchResults</code> al <code>PlatosViewController</code>, <strong>aquí es donde realmente tienes que implementar el filtrado (en un momento veremos cómo)</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span> <span class="nf">updateSearchResults</span><span class="p">(</span><span class="k">for</span> <span class="n">searchController</span><span class="p">:</span> <span class="bp">UISearchController</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//este throttler.throttle solo si quieres usar throttling</span>
    <span class="c1">//en caso contrario solo el let textoBuscado=... etc</span>
    <span class="n">throttler</span><span class="p">.</span><span class="n">throttle</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nv">textoBuscado</span> <span class="p">=</span> <span class="n">searchController</span><span class="p">.</span><span class="n">searchBar</span><span class="p">.</span><span class="n">text</span><span class="p">!</span>
        <span class="c1">//Aquí iría tu código de búsqueda</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Borrar la cache</p>
<p>Ya hemos comentado que el <code>NSFetchedResultsController</code> no necesita cache, pero si la tuviera, en este momento se debería borrar con el método <code>NSFetchedResultsController.deleteCache(withName:)</code> para evitar un error al cambiar la <em>fetch request</em>.</p>
</div>
<p><strong>Crea un predicado (<code>NSPredicate</code>) con la condición de búsqueda apropiada</strong> para buscar el <code>textoBuscado</code> en el nombre o la descripción (no debe distinguir mayúsculas/minúsculas ni acentos) y <strong>asígnaselo a la propiedad <code>fetchRequest.predicate</code></strong> del <code>NSFetchedResultsController</code>. </p>
<div class="admonition info">
<p class="admonition-title">Ayuda</p>
<p>Para lo anterior, puedes usar como guía el apartado <em><a href="../../cap6/1_predicados/#predicados-como-cadenas/">"Predicados como cadenas"</a></em> del tema de búsquedas en Core Data.</p>
</div>
<p>Para que se actualicen los datos tendrás que hacer:</p>
<p><div class="highlight"><pre><span></span><code><span class="k">try</span><span class="p">!</span> <span class="kc">self</span><span class="p">.</span><span class="n">frc</span><span class="p">.</span><span class="n">performFetch</span><span class="p">()</span>
<span class="kc">self</span><span class="p">.</span><span class="n">tabla</span><span class="p">.</span><span class="n">reloadData</span><span class="p">()</span>
</code></pre></div>
Tras hacer esto ya debería funcionar el filtrado de platos, compruébalo.</p>
<div class="admonition warning">
<p class="admonition-title">Problema con las búsquedas</p>
<p>Si pruebas la búsqueda verás que con el cuadro de búsqueda inicialmente vacío se muestran todos los platos, cuando escribes algo se filtran pero <strong>cuando vuelves a borrar y lo dejas vacío no se ve ningún plato</strong>. Esto es porque aunque <code>textoBuscado</code>sea vacío sigue actuando el predicado de búsqueda. ¿Se te ocurre cómo podrías arreglarlo? Inténtalo.</p>
</div>
<h3 id="anadir-al-pedido-actual">Añadir al pedido actual<a class="headerlink" href="#anadir-al-pedido-actual" title="Permanent link">&para;</a></h3>
<p>Las celdas de la tabla tienen un <em>delegate</em> al que  avisarán de que se ha pulsado el botón "Añadir". Cada celda almacena su <code>IndexPath</code> (su número de fila y de sección) y tiene como <em>delegate</em> al <em>controller</em> de la pantalla.</p>
<p>Para avisar al <em>controller</em> de que se ha pulsado sobre "Añadir" se llama al <strong>método <code>platoAñadido</code>. En este método tienes que obtener la entidad <code>Plato</code> elegida (la que está en la fila y sección seleccionadas)</strong> para que el código restante (ya implementado) se lo pase al controller de la pantalla siguiente.</p>
<div class="admonition warning líneas por descomentar">
<p class="admonition-title">Warning</p>
<p>Tendrás que descomentar además la línea que pone <code>//TODO: descomentar esta línea</code> del <code>PlatosViewController</code> y la 21 del <code>PedidoActualViewController</code>. Estaban comentadas para que el código compilara en el estado inicial del proyecto, antes de que existiera la entidad "Plato"</p>
</div>
<p>Para probar que está bien, en el <code>viewDidLoad</code> del <code>PedidoActualViewController</code> imprime en la consola con <code>print</code> algún dato de la propiedad <code>platoElegido</code>, para comprobar que se corresponde con el seleccionado. De momento el plato no aparece todavía en la pantalla del móvil, de eso nos ocuparemos en el siguiente apartado.</p>
<h2 id="funcionalidad-el-pedido-actual-075-puntos">Funcionalidad: El pedido actual (0,75 puntos)<a class="headerlink" href="#funcionalidad-el-pedido-actual-075-puntos" title="Permanent link">&para;</a></h2>
<p>Esta parte de la <em>app</em> muestra los datos del pedido actual, añade los platos seleccionados al pedido y permite hacer el pedido o cancelarlo. La pantalla está controlada por el <code>PedidoActualViewController</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Problemas con el Tab bar</p>
<p>A esta pantalla se puede llegar de dos modos, al añadir un plato al pedido o bien con el botón "Tu pedido" del <em>tab bar</em> en la parte inferior de la pantalla. Mientras estés implementando esta pantalla es probable que el botón del <em>tab bar</em> cause un error fatal, al final veremos por qué y lo intentaremos arreglar.</p>
</div>
<p>El pedido actual no se puede guardar en el propio <em>controller</em> ya que por la navegación entre pantallas este se destruiría al salir de ella. Por eso se debe guardar aparte, en la variable <code>pedidoActual</code> del <em>singleton</em> <code>StateSingleton.shared</code>. <strong>Esta variable estaba comentada para que no diera error</strong>  ya que hasta que no creaste el modelo de datos no existía la entidad <code>Pedido</code>, <strong>descoméntala</strong> (línea 5 de carpeta State/Archivo StateSingleton.swift). </p>
<h3 id="anadir-el-plato-elegido-al-pedido">Añadir el plato elegido al pedido<a class="headerlink" href="#anadir-el-plato-elegido-al-pedido" title="Permanent link">&para;</a></h3>
<p>En el <code>viewDidLoad</code> de <code>PedidoActualViewController</code> nos tenemos que ocupar de añadir el plato elegido al pedido actual</p>
<ul>
<li>Primero <strong>comprueba si no hay en memoria un <code>Pedido</code> actual (<code>StateSingleton.shared.pedidoActual==nil</code>), y si es así créalo en Core Data, guárdalo en el <code>StateSingleton</code> y haz save() del contexto de persistencia</strong></li>
<li><strong>Crea una nueva <code>LineaPedido</code></strong><ul>
<li>Asígnale cantidad 1 (luego se podrá cambiar con los botones de <code>+/-</code>)</li>
<li>Asóciala con el plato elegido. Recuerda que el plato elegido debería estar en la propiedad <code>platoElegido</code> del controller.</li>
<li>Asóciala con el pedido</li>
</ul>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Asociar entidades en Core Data</p>
<p>Recuerda que las relaciones en Core Data son como propiedades de los objetos. Por ejemplo para asociar una línea de pedido con un plato harías simplemente
<div class="highlight"><pre><span></span><code><span class="c1">//Suponiendo que &quot;linea&quot; es de tipo LineaPedido y &quot;elPlato&quot; de tipo &quot;Plato&quot;</span>
<span class="n">linea</span><span class="p">.</span><span class="n">plato</span> <span class="p">=</span> <span class="n">elPlato</span>
</code></pre></div>
Si la relación es "a muchos" tendrías que usar un método de los generados por xCode que empiezan por <code>addTo...</code>. El ejemplo anterior lo podrías hacer también como</p>
<div class="highlight"><pre><span></span><code><span class="n">elPlato</span><span class="p">.</span><span class="n">addToLineasPedido</span><span class="p">(</span><span class="n">linea</span><span class="p">)</span>
</code></pre></div>
<p>Aunque es mucho menos intuitivo</p>
</div>
<ul>
<li><strong>Guarda el contexto de persistencia</strong> con <code>save()</code> para que los cambios tengan efecto en la BD.</li>
</ul>
<h3 id="listar-los-platos-del-pedido">Listar los platos del pedido<a class="headerlink" href="#listar-los-platos-del-pedido" title="Permanent link">&para;</a></h3>
<p>Como puedes ver en el código del <code>PedidoActualViewController</code> éste hace de <code>UITableViewDataSource</code>, es decir es el responsable de darle a iOS los datos para pintar la tabla que muestre el pedido actual.</p>
<p><strong>Tendrás que completar el código de los métodos</strong></p>
<ul>
<li><code>tableView(_ tableView: UITableView, numberOfRowsInSection section: Int)</code></li>
<li><code>tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath)</code> </li>
</ul>
<p>para que la tabla se vea en pantalla. La celda es de la clase <code>LineaPedidoTableViewCell</code> y como podrás ver en ella tiene un <code>nombreLabel</code> y un <code>cantidadLabel</code> que son los datos que tendrás que rellenar con el nombre del plato y la cantidad de la línea de pedido respectivamente.</p>
<h3 id="cambiar-la-cantidad-de-un-plato">Cambiar la cantidad de un plato<a class="headerlink" href="#cambiar-la-cantidad-de-un-plato" title="Permanent link">&para;</a></h3>
<p>En esta pantalla también se puede cambiar el número de unidades que queremos pedir de un plato. </p>
<blockquote>
<p>Para simplificar se supondrá que solo podemos movernos entre 1 y 100, no podemos bajar las unidades a 0 y eliminar el plato</p>
</blockquote>
<p>Al igual que en la pantalla anterior se usa la idea de <em>delegate</em> para saber qué celda se está seleccionando. Las celdas son de la clase <code>LineaPedidoTableviewCell</code>, y cada vez que se pulsa en un <code>+</code> o un <code>-</code> se avisa al <em>delegate</em> (en este caso el controller), pasándole el número de la fila.</p>
<p>La interfaz ya está configurada para que el método <code>cantidadCambiada</code> del controller se llame cada vez que el usuario cambia la cantidad de un plato. <strong>Añádele código que obtenga la línea de pedido correspondiente, cambie la cantidad y guarde el contexto de persistencia</strong></p>
<h3 id="realizar-y-cancelar-pedido">Realizar y cancelar pedido<a class="headerlink" href="#realizar-y-cancelar-pedido" title="Permanent link">&para;</a></h3>
<p>En la pantalla tienes dos botones para realizar y cancelar el pedido. </p>
<ul>
<li>Si se pulsa a "realizar" bastará con que le asignes la fecha actual al pedido, crees un nuevo pedido en <code>StateSingleton.shared.pedidoActual</code> y muestres un mensaje al usuario indicando que "su pedido está en camino" o algo similar</li>
<li>Si se pulsa a "cancelar" deberías borrar en Core Data el pedido actual. Si la regla de borrado en cascada está puesta correctamente, al borrar un pedido deberían borrarse 
automáticamente todas sus líneas.</li>
</ul>
<h3 id="el-boton-tu-pedido-del-tab-bar">El botón "Tu pedido" del <em>tab bar</em><a class="headerlink" href="#el-boton-tu-pedido-del-tab-bar" title="Permanent link">&para;</a></h3>
<p>Como ya hemos comentado, a la pantalla de pedido actual también se puede llegar pulsando el botón de "Tu pedido" en el <em>tab bar</em> inferior. No obstante, como al ir por este camino no hay un <code>platoElegido</code> es bastante probable que tu código falle al asumir que sí lo hay. Si falla, cambia el código para que si  hay <code>platoElegido</code> (<code>!=nil</code>)  cree la nueva línea de pedido pero no lo haga si es <code>nil</code>.</p>
<h2 id="funcionalidad-tu-historial-hasta-05-puntos">Funcionalidad: Tu historial (hasta 0,5 puntos)<a class="headerlink" href="#funcionalidad-tu-historial-hasta-05-puntos" title="Permanent link">&para;</a></h2>
<p>En esta pantalla se deberían mostrar todos los pedidos realizados por el usuario actual. La pantalla está controlada por el (<code>PedidosViewController</code>). Está en blanco y puedes crear la interfaz del modo que desees.</p>
<ul>
<li>(0,25 puntos) Si en el <code>viewWillAppear</code> muestras los datos de todos los pedidos en la consola con <code>print</code>, solo para ver que efectivamente se han almacenado correctamente</li>
<li>(0,5 puntos) Si en lugar de lo anterior muestras en una tabla una línea con el resumen de cada pedido (fecha, total y número de platos pedidos)</li>
</ul>
<h2 id="apendice-diagrama-uml-de-las-clases-del-proyecto">Apéndice: diagrama UML de las clases del proyecto<a class="headerlink" href="#apendice-diagrama-uml-de-las-clases-del-proyecto" title="Permanent link">&para;</a></h2>
<p><img alt="" src="../uml_restaurante.svg" /></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Pie" >
      
        
        <a href="../../cap7/6_ejercicios/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Ejercicios" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              Ejercicios
            </div>
          </div>
        </a>
      
      
        
        <a href="../../cap8/1_intro/" class="md-footer__link md-footer__link--next" aria-label="Siguiente: Qué son las migraciones de datos" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Siguiente
              </span>
              Qué son las migraciones de datos
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.078830c0.min.js"></script>
      
    
  </body>
</html>