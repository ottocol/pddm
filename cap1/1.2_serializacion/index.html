
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.1, mkdocs-material-8.5.6">
    
    
      
        <title>Serialización - PDDM-iOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#serializacioncodificacion-de-datos" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="PDDM-iOS" class="md-header__button md-logo" aria-label="PDDM-iOS" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PDDM-iOS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Serialización
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PDDM-iOS" class="md-nav__button md-logo" aria-label="PDDM-iOS" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    PDDM-iOS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Persistencia básica
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Persistencia básica" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Persistencia básica
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.0_introduccion/" class="md-nav__link">
        Introducción
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.1_sistema_de_archivos/" class="md-nav__link">
        Sistema de archivos
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Serialización
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Serialización
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#serializacioncodificacion-de-datos" class="md-nav__link">
    Serialización/Codificación de datos
  </a>
  
    <nav class="md-nav" aria-label="Serialización/Codificación de datos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#el-protocolo-codable" class="md-nav__link">
    El protocolo Codable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#almacenar-codable-en-archivos" class="md-nav__link">
    Almacenar Codable en archivos
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurar-codable" class="md-nav__link">
    Configurar Codable
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.3_property_lists/" class="md-nav__link">
        Property lists
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.4_preferencias/" class="md-nav__link">
        Preferencias
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          ¡Hola Core Data!. Una aplicación de ejemplo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="¡Hola Core Data!. Una aplicación de ejemplo" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          ¡Hola Core Data!. Una aplicación de ejemplo
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.1_intro/" class="md-nav__link">
        Introducción a Core Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.2_stack/" class="md-nav__link">
        Crear el stack de Core Data en iOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.3_entidades/" class="md-nav__link">
        Ejercicio parte I. almacenar datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/3.4_recuperar_datos/" class="md-nav__link">
        Ejercicio parte II. recuperar los datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap3/apendice_ver_almacenamiento/" class="md-nav__link">
        Apéndice. Cómo examinar el almacenamiento persistente
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Modelos de datos en Core Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Modelos de datos en Core Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Modelos de datos en Core Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.1_crear_modelo/" class="md-nav__link">
        Crear y editar modelos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.2_clases_propias/" class="md-nav__link">
        Modelar las entidades en código Swift
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.3_CRUD/" class="md-nav__link">
        CRUD en Core Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.4_validaciones/" class="md-nav__link">
        Validaciones
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.5_otros_tipos/" class="md-nav__link">
        Otros tipos de datos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap4/4.6_ejercicios/" class="md-nav__link">
        Ejercicios de modelos de datos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Búsquedas en Core Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Búsquedas en Core Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Búsquedas en Core Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap6/1_predicados/" class="md-nav__link">
        Predicados
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap6/2_ordenacion/" class="md-nav__link">
        Ordenación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap6/3_ejercicios/" class="md-nav__link">
        Ejercicios
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Tablas en Core Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tablas en Core Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Tablas en Core Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/1_el_frc/" class="md-nav__link">
        El "fetched results controller"
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/2_configuracion_basica/" class="md-nav__link">
        Inicializar el "fetched results controller"
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/3_tabla/" class="md-nav__link">
        Mostrar los datos en la tabla
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/4_refrescar_tabla/" class="md-nav__link">
        Refrescar la tabla
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/5_secciones/" class="md-nav__link">
        Secciones de tabla automáticas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cap7/6_ejercicios/" class="md-nav__link">
        Ejercicios
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#serializacioncodificacion-de-datos" class="md-nav__link">
    Serialización/Codificación de datos
  </a>
  
    <nav class="md-nav" aria-label="Serialización/Codificación de datos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#el-protocolo-codable" class="md-nav__link">
    El protocolo Codable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#almacenar-codable-en-archivos" class="md-nav__link">
    Almacenar Codable en archivos
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurar-codable" class="md-nav__link">
    Configurar Codable
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Serialización</h1>

<h2 id="serializacioncodificacion-de-datos">Serialización/Codificación de datos<a class="headerlink" href="#serializacioncodificacion-de-datos" title="Permanent link">&para;</a></h2>
<p>Desde la versión 4 de Swift la serialización de datos en iOS se ha uniformizado en lo que se denomina <em>encoding/decoding</em>. El <em>encoding</em> es el proceso que nos permite pasar de una estructura de datos en memoria a otro formato más adecuado para archivar o transmitir la información, por ejemplo JSON, XML,... El <em>decoding</em> es el proceso inverso. </p>
<h3 id="el-protocolo-codable">El protocolo <code>Codable</code><a class="headerlink" href="#el-protocolo-codable" title="Permanent link">&para;</a></h3>
<p>Para que un objeto sea "codificable/decodificable" debe implementar este protocolo. En la mayoría de casos no será necesario escribir nada de código, siempre que nuestra clase/struct esté compuesta por campos que sean conformes con <code>Codable</code>. Muchos tipos básicos de Swift lo son, como los <code>String</code>, <code>Int</code>, <code>Float</code>, <code>Date</code>, <code>Array</code>...</p>
<blockquote>
<p>En realidad <code>Codable</code> no es más que una combinación de los protocolos, <code>Encodable</code> (para codificar) y <code>Decodable</code> (para decodificar):</p>
</blockquote>
<p>Como ejemplo, supongamos que tenemos una estructura <code>Alumno</code> que representa un alumno de un determinado curso o asignatura. Su definición podría ser algo como:</p>
<div class="highlight"><pre><span></span><code><span class="kd">struct</span> <span class="nc">Alumno</span>  <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">nombre</span> <span class="p">:</span> <span class="nb">String</span>
    <span class="kd">var</span> <span class="nv">nota</span><span class="p">:</span> <span class="nb">Float</span>
    <span class="kd">var</span> <span class="nv">fechaNacimiento</span><span class="p">:</span> <span class="n">Date</span>
<span class="p">}</span>
</code></pre></div>
<p>Como los campos de la clase son conformes a <code>Codable</code> para que la propia clase lo sea nos basta con declararla como tal:</p>
<div class="highlight"><pre><span></span><code><span class="kd">struct</span> <span class="nc">Alumno</span> <span class="p">:</span> <span class="n">Codable</span> <span class="p">{</span>
    <span class="c1">//..el resto es exactamente igual</span>
<span class="p">}</span>
</code></pre></div>
<p>Ahora solo necesitamos un "encoder", una clase capaz de transformar algo <code>Codable</code> en un formato determinado. En los APIs de iOS tenemos <em>encoders</em> para transformar a/desde formatos como JSON o XML. En la siguiente sección veremos un ejemplo.</p>
<h3 id="almacenar-codable-en-archivos">Almacenar <code>Codable</code> en archivos<a class="headerlink" href="#almacenar-codable-en-archivos" title="Permanent link">&para;</a></h3>
<p>Una posibilidad es transformar nuestros datos <code>Codable</code> en JSON, XML o un formato para el que tengamos un <em>encoder</em> y luego almacenar el formato resultante en un archivo. </p>
<p>Veamos un ejemplo con JSON:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//Esto se usa solo para poder generar fechas a partir de cadenas,</span>
<span class="c1">//no está relacionado directamente con la serialización</span>
<span class="kd">let</span> <span class="nv">df</span> <span class="p">=</span> <span class="n">DateFormatter</span><span class="p">()</span> 
<span class="n">df</span><span class="p">.</span><span class="n">dateFormat</span> <span class="p">=</span> <span class="s">&quot;dd-MM-yyyy&quot;</span>
<span class="c1">//Definir un alumo cuyos datos guardaremos</span>
<span class="kd">let</span> <span class="nv">alumno</span> <span class="p">=</span> <span class="n">Alumno</span><span class="p">(</span><span class="n">nombre</span><span class="p">:</span> <span class="s">&quot;Pepe&quot;</span><span class="p">,</span> <span class="n">nota</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">fechaNacimiento</span><span class="p">:</span> <span class="n">df</span><span class="p">.</span><span class="n">date</span><span class="p">(</span><span class="n">from</span><span class="p">:</span> <span class="s">&quot;10/10/2000&quot;</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>

<span class="c1">//Convertir el alumno a JSON</span>
<span class="kd">let</span> <span class="nv">encoder</span> <span class="p">=</span> <span class="n">JSONEncoder</span><span class="p">()</span>
<span class="kd">let</span> <span class="nv">datos</span> <span class="p">=</span> <span class="k">try</span><span class="p">!</span> <span class="n">encoder</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="n">alumno</span><span class="p">)</span>

<span class="c1">//Almacenarlo en un archivo llamado &quot;result.json&quot; en la carpeta Documents</span>
<span class="kd">var</span> <span class="nv">urlDocs</span> <span class="p">=</span> <span class="n">FileManager</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">urls</span><span class="p">(</span><span class="k">for</span><span class="p">:.</span><span class="n">documentDirectory</span><span class="p">,</span>
                                       <span class="k">in</span><span class="p">:.</span><span class="n">userDomainMask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="kd">let</span> <span class="nv">urlFichero</span> <span class="p">=</span> <span class="n">urlDocs</span><span class="p">.</span><span class="n">appendingPathComponent</span><span class="p">(</span><span class="s">&quot;result.json&quot;</span><span class="p">)</span>
<span class="k">try</span><span class="p">!</span> <span class="n">datos</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="n">urlFichero</span><span class="p">)</span>
</code></pre></div>
<p>En JSON hay algunos tipos de datos, como las fechas, que no están estandarizados. El <code>JSONEncoder</code> soporta varios formatos, que podemos seleccionar a través de la propiedad <code>dateEncodingStrategy</code>. Por ejemplo para guardar las fechas en formato ISO8601:</p>
<div class="highlight"><pre><span></span><code><span class="n">encoder</span><span class="p">.</span><span class="n">dateEncodingStrategy</span> <span class="p">=</span> <span class="p">.</span><span class="n">iso8601</span>
</code></pre></div>
<p>Para leer los datos del archivo usaríamos un <code>JSONDecoder</code></p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nv">datosLeidos</span> <span class="p">=</span> <span class="k">try</span> <span class="n">Data</span><span class="p">(</span><span class="n">contentsOf</span><span class="p">:</span> <span class="n">urlFichero</span><span class="p">)</span>
<span class="kd">let</span> <span class="nv">decoder</span> <span class="p">=</span> <span class="n">JSONDecoder</span><span class="p">()</span>
<span class="kd">let</span> <span class="nv">alumnoLeido</span> <span class="p">=</span> <span class="k">try</span> <span class="n">decoder</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">Jugador</span><span class="p">.</span><span class="kc">self</span><span class="p">,</span> <span class="n">from</span><span class="p">:</span> <span class="n">datosLeidos</span><span class="p">)</span>
</code></pre></div>
<p>Si al almacenar los datos hubiéramos cambiado el formato de fecha, tendríamos que cambiarlo en la propiedad <code>dateDecodingStrategy</code> del <em>decoder</em>. </p>
<p>Otra opción en lugar de usar JSON o XML es usar las clases <code>NSKeyedArchiver</code> y <code>NSKeyedUnarchiver</code> que sirven para "archivar" y "desarchivar" <code>Codable</code>s, respectivamente. </p>
<p>Para codificar los datos usamos el método <code>encodeEncodable</code> de <code>NSKeyedArchiver</code></p>
<div class="highlight"><pre><span></span><code><span class="c1">//Alumno que luego guardaremos</span>
<span class="kd">let</span> <span class="nv">df</span> <span class="p">=</span> <span class="n">DateFormatter</span><span class="p">()</span>
<span class="n">df</span><span class="p">.</span><span class="n">dateFormat</span> <span class="p">=</span> <span class="s">&quot;dd-MM-yyyy&quot;</span>
<span class="kd">let</span> <span class="nv">alumno1</span> <span class="p">=</span> <span class="n">Alumno</span><span class="p">(</span><span class="n">nombre</span><span class="p">:</span> <span class="s">&quot;Pepe&quot;</span><span class="p">,</span> <span class="n">nota</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">fechaNacimiento</span><span class="p">:</span> <span class="n">df</span><span class="p">.</span><span class="n">date</span><span class="p">(</span><span class="n">from</span><span class="p">:</span> <span class="s">&quot;10/10/2000&quot;</span><span class="p">)</span><span class="o">!</span><span class="p">)</span>
<span class="c1">//El archivo se llamará &quot;datos.dat&quot; dentro del directorio de documentos de la app</span>
<span class="kd">let</span> <span class="nv">urlDocs</span> <span class="p">=</span> <span class="n">FileManager</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">urls</span><span class="p">(</span><span class="k">for</span><span class="p">:.</span><span class="n">documentDirectory</span><span class="p">,</span>  
                                       <span class="k">in</span><span class="p">:.</span><span class="n">userDomainMask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="kd">let</span> <span class="nv">urlArchivo</span> <span class="p">=</span> <span class="n">urlDocs</span><span class="p">.</span><span class="n">appendingPathComponent</span><span class="p">(</span><span class="s">&quot;datos.dat&quot;</span><span class="p">)</span>
<span class="kd">let</span> <span class="nv">archiver</span> <span class="p">=</span> <span class="bp">NSKeyedArchiver</span><span class="p">()</span>
<span class="k">do</span> <span class="p">{</span>
   <span class="c1">//codificamos  </span>
   <span class="k">try</span> <span class="n">archiver</span><span class="p">.</span><span class="n">encodeEncodable</span><span class="p">(</span><span class="n">alumno1</span><span class="p">,</span> <span class="n">forKey</span><span class="p">:</span> <span class="n">NSKeyedArchiveRootObjectKey</span><span class="p">)</span>
   <span class="c1">//los datos codificados están en &quot;encodedData&quot;. Los guardamos en el archivo</span>
   <span class="k">try</span> <span class="n">archiver</span><span class="p">.</span><span class="n">encodedData</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="n">urlArchivo</span><span class="p">)</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
    <span class="bp">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Para el paso contrario (<em>decoding</em>) usamos el método <code>decodeTopLevelDecodable</code> de <code>NSKeyedUnarchiver</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//aquí &quot;urlArchivo&quot; tiene el mismo valor que en el ejemplo anterior</span>
<span class="kd">let</span> <span class="nv">datos</span> <span class="p">=</span> <span class="k">try</span> <span class="n">Data</span><span class="p">(</span><span class="n">contentsOf</span><span class="p">:</span> <span class="n">urlArchivo</span><span class="p">)</span>
<span class="kd">let</span> <span class="nv">unarchiver</span> <span class="p">=</span> <span class="bp">NSKeyedUnarchiver</span><span class="p">(</span><span class="n">forReadingWith</span><span class="p">:</span> <span class="n">datos</span><span class="p">)</span>
<span class="k">if</span> <span class="kd">let</span> <span class="nv">alumnoLeido</span> <span class="p">=</span> <span class="k">try</span> <span class="n">unarchiver</span><span class="p">.</span><span class="n">decodeTopLevelDecodable</span><span class="p">(</span><span class="n">Alumno</span><span class="p">.</span><span class="kc">self</span><span class="p">,</span> 
                                      <span class="n">forKey</span><span class="p">:</span> <span class="n">NSKeyedArchiveRootObjectKey</span><span class="p">)</span> <span class="p">{</span>
   <span class="bp">print</span><span class="p">(</span><span class="n">alumnoLeido</span><span class="p">.</span><span class="n">nombre</span><span class="p">)</span> <span class="c1">//Pepe</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<blockquote>
<p>En realidad estas clases existen desde antes de la introducción de <code>Codable</code>. Se usaban para guardar datos mediante el mecanismo que existía anteriormente en iOS, denominado <code>NSCoding</code>, y se extendieron para poder trabajar también con <code>Codable</code>.</p>
</blockquote>
</blockquote>
<h2 id="configurar-codable">Configurar Codable<a class="headerlink" href="#configurar-codable" title="Permanent link">&para;</a></h2>
<p>En algunas ocasiones nos puede interesar serializar/deserializar los datos usando nombres de campos distintos a los que usamos en nuestras estructuras de datos. Por ejemplo en muchas ocasiones nos tendremos que comunicar con servicios REST cuyo JSON use nombres que nos pueden resultar extraños en nuestro código, o que no se adaptan a las convenciones de Swift.</p>
<p>La asociación entre los nombres de los campos en el formato serializado y en nuestro código se puede definir en una enumeración de <code>String</code>s llamada <code>CodingKeys</code> que debe ser conforme al protocolo <code>CodingKey</code>. </p>
<p>Supongamos que en el ejemplo del <code>struct Alumno</code> queremos que en nuestra estructura de datos la fecha se siga llamando <code>fechaNacimiento</code> pero en el formato serializado sea <code>fecha_nacimiento</code>. Lo haríamos del siguiente modo:</p>
<div class="highlight"><pre><span></span><code><span class="kd">struct</span> <span class="nc">Alumno</span>  <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">nombre</span> <span class="p">:</span> <span class="nb">String</span>
    <span class="kd">var</span> <span class="nv">nota</span><span class="p">:</span> <span class="nb">Float</span>
    <span class="kd">var</span> <span class="nv">fechaNacimiento</span><span class="p">:</span> <span class="n">Date</span>
    <span class="kd">private</span> <span class="kd">enum</span> <span class="nc">CodingKeys</span> <span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="n">CodingKey</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">nombre</span>
        <span class="k">case</span> <span class="n">nota</span>
        <span class="k">case</span> <span class="n">fechaNacimiento</span> <span class="p">=</span> <span class="s">&quot;fecha_nacimiento&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Pie" >
      
        
        <a href="../1.1_sistema_de_archivos/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Sistema de archivos" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              Sistema de archivos
            </div>
          </div>
        </a>
      
      
        
        <a href="../1.3_property_lists/" class="md-footer__link md-footer__link--next" aria-label="Siguiente: Property lists" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Siguiente
              </span>
              Property lists
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.078830c0.min.js"></script>
      
    
  </body>
</html>