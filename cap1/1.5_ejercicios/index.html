



<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>Ejercicios - PDDM-iOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#ejercicio-de-persistencia-basica-serializacion-y-preferencias-de-usuario-5-puntos" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="PDDM-iOS" class="md-header-nav__button md-logo">
          
            <img src="../../logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              PDDM-iOS
            </span>
            <span class="md-header-nav__topic">
              
                Ejercicios
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="PDDM-iOS" class="md-nav__button md-logo">
      
        <img src="../../logo.png" width="48" height="48">
      
    </a>
    PDDM-iOS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" checked>
    
    <label class="md-nav__link" for="nav-1">
      Persistencia básica
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Persistencia básica
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../1.1_sistema_de_archivos/" title="Sistema de archivos" class="md-nav__link">
      Sistema de archivos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../1.2_serializacion/" title="Serialización" class="md-nav__link">
      Serialización
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../1.3_property_lists/" title="Property lists" class="md-nav__link">
      Property lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../1.4_preferencias/" title="Preferencias" class="md-nav__link">
      Preferencias
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Ejercicios
      </label>
    
    <a href="./" title="Ejercicios" class="md-nav__link md-nav__link--active">
      Ejercicios
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ejercicio-de-persistencia-basica-serializacion-y-preferencias-de-usuario-5-puntos" class="md-nav__link">
    Ejercicio de persistencia básica: serialización y preferencias de usuario (5 puntos)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interfaz-grafico-05-puntos" class="md-nav__link">
    Interfaz gráfico (0,5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detectar-que-salimos-de-la-aplicacion-05-puntos" class="md-nav__link">
    Detectar que salimos de la aplicación (0,5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#almacenar-los-datos-en-un-archivo-15-puntos" class="md-nav__link">
    Almacenar los datos en un archivo (1.5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recuperar-los-datos-del-archivo-1-puntos" class="md-nav__link">
    Recuperar los datos del archivo (1 puntos)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicio-2-preferencias-de-usuario-15-puntos" class="md-nav__link">
    Ejercicio 2: Preferencias de usuario (1.5 puntos)
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      SQLite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        SQLite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap2/2.1_intro_SQLite/" title="Introducción" class="md-nav__link">
      Introducción
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap2/2.2_API_SQLite/" title="El API de SQLIte" class="md-nav__link">
      El API de SQLIte
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap2/2.3_frameworks/" title="Frameworks para SQLite" class="md-nav__link">
      Frameworks para SQLite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap2/2.4_ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Persistencia como servicio
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Persistencia como servicio
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap11/1_introduccion_BAAS/" title="Backend as a Service" class="md-nav__link">
      Backend as a Service
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap11/2_gestion_usuarios/" title="Gestión de usuarios en Firebase" class="md-nav__link">
      Gestión de usuarios en Firebase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap11/3_persistencia/" title="Persistencia en Firebase" class="md-nav__link">
      Persistencia en Firebase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap11/4_ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      ¡Hola Core Data!. Una aplicación de ejemplo
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        ¡Hola Core Data!. Una aplicación de ejemplo
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap3/3.1_intro/" title="Introducción a Core Data" class="md-nav__link">
      Introducción a Core Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap3/3.2_stack/" title="Crear el stack de Core Data en iOS" class="md-nav__link">
      Crear el stack de Core Data en iOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap3/3.3_entidades/" title="Las entidades. Almacenar datos" class="md-nav__link">
      Las entidades. Almacenar datos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap3/3.4_recuperar_datos/" title="Recuperar los datos" class="md-nav__link">
      Recuperar los datos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Modelos de datos en Core Data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Modelos de datos en Core Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap4/4.1_crear_modelo/" title="Crear y editar modelos" class="md-nav__link">
      Crear y editar modelos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap4/4.2_clases_propias/" title="Modelar las entidades en código Swift" class="md-nav__link">
      Modelar las entidades en código Swift
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap4/4.3_CRUD/" title="CRUD en Core Data" class="md-nav__link">
      CRUD en Core Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap4/4.4_ejercicios/" title="Ejercicios de modelos de datos" class="md-nav__link">
      Ejercicios de modelos de datos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Búsquedas en Core Data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Búsquedas en Core Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap6/1_predicados/" title="Predicados" class="md-nav__link">
      Predicados
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap6/2_ordenacion/" title="Ordenación" class="md-nav__link">
      Ordenación
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap6/3_ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Tablas en Core Data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Tablas en Core Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap7/1_el_frc/" title="El *fetched results controller*" class="md-nav__link">
      El *fetched results controller*
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap7/2_configuracion_basica/" title="Inicializar el "fetched results controller"" class="md-nav__link">
      Inicializar el "fetched results controller"
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap7/3_tabla/" title="Mostrar los datos en la tabla" class="md-nav__link">
      Mostrar los datos en la tabla
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap7/4_refrescar_tabla/" title="Refrescar la tabla" class="md-nav__link">
      Refrescar la tabla
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap7/5_secciones/" title="Secciones de tabla automáticas" class="md-nav__link">
      Secciones de tabla automáticas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap7/6_ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Migraciones de datos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Migraciones de datos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap8/1_intro/" title="Qué son las migraciones de datos" class="md-nav__link">
      Qué son las migraciones de datos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap8/2_versiones/" title="Versiones del modelo de datos" class="md-nav__link">
      Versiones del modelo de datos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap8/3_migraciones_ligeras/" title="Migraciones ligeras" class="md-nav__link">
      Migraciones ligeras
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap8/4_migraciones_pesadas/" title="Migraciones pesadas" class="md-nav__link">
      Migraciones pesadas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap8/5_ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap8/apendice_migraciones_ios9/" title="Apéndice. migraciones en versiones antiguas de iOS" class="md-nav__link">
      Apéndice. migraciones en versiones antiguas de iOS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Concurrencia. Contextos múltiples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Concurrencia. Contextos múltiples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap9/1_background/" title="Múltiples contextos para trabajos en *background*" class="md-nav__link">
      Múltiples contextos para trabajos en *background*
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap9/2_comunicacion/" title="Comunicación entre contextos" class="md-nav__link">
      Comunicación entre contextos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap9/3_contextos_anidados/" title="Contextos anidados" class="md-nav__link">
      Contextos anidados
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap9/4_ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Arquitecturas de aplicaciones en iOS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Arquitecturas de aplicaciones en iOS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap10/intro/" title="Introducción" class="md-nav__link">
      Introducción
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap10/2_MVC/" title="Model/View/Controller" class="md-nav__link">
      Model/View/Controller
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap10/3_MVP/" title="Model/View/Presenter" class="md-nav__link">
      Model/View/Presenter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap10/4_MVVM/" title="Model/View/ViewModel" class="md-nav__link">
      Model/View/ViewModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap10/5_VIPER/" title="VIPER" class="md-nav__link">
      VIPER
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap10/6a_ejercicios1/" title="Ejercicios parte I" class="md-nav__link">
      Ejercicios parte I
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap10/6_ejercicios/" title="Ejercicios parte II" class="md-nav__link">
      Ejercicios parte II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cap10/6_ejercicios_redux/" title="Ejercicios parte III" class="md-nav__link">
      Ejercicios parte III
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ejercicio-de-persistencia-basica-serializacion-y-preferencias-de-usuario-5-puntos" class="md-nav__link">
    Ejercicio de persistencia básica: serialización y preferencias de usuario (5 puntos)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#interfaz-grafico-05-puntos" class="md-nav__link">
    Interfaz gráfico (0,5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detectar-que-salimos-de-la-aplicacion-05-puntos" class="md-nav__link">
    Detectar que salimos de la aplicación (0,5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#almacenar-los-datos-en-un-archivo-15-puntos" class="md-nav__link">
    Almacenar los datos en un archivo (1.5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recuperar-los-datos-del-archivo-1-puntos" class="md-nav__link">
    Recuperar los datos del archivo (1 puntos)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicio-2-preferencias-de-usuario-15-puntos" class="md-nav__link">
    Ejercicio 2: Preferencias de usuario (1.5 puntos)
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Ejercicios</h1>
                
                <h2 id="ejercicio-de-persistencia-basica-serializacion-y-preferencias-de-usuario-5-puntos">Ejercicio de persistencia básica: serialización y preferencias de usuario (5 puntos)<a class="headerlink" href="#ejercicio-de-persistencia-basica-serializacion-y-preferencias-de-usuario-5-puntos" title="Permanent link">&para;</a></h2>
<p>Vamos a realizar una pequeña aplicación en la que los datos se guarden usando algunos de los mecanismos vistos en la sesión. Desde el punto de vista del usuario consistirá en una única "pantalla" con un <code>Text View</code> para editar un mensaje y un <code>Label</code> que mostrará la fecha y hora de edición. Los datos deben conservarse aunque salgamos de la aplicación.</p>
<p>Llama al proyecto <code>PersistenciaBasica</code>.</p>
<h3 id="interfaz-grafico-05-puntos">Interfaz gráfico (0,5 puntos)<a class="headerlink" href="#interfaz-grafico-05-puntos" title="Permanent link">&para;</a></h3>
<p>Crea la interfaz:</p>
<ul>
<li>Inserta el <code>Text View</code> y el <code>Label</code> en el <em>storyboard</em></li>
<li>En el <code>ViewController</code><ul>
<li>Crea dos <em>outlet</em> para acceder al contenido de ambos componentes. Recuerda que tienes que hacer <code>Ctrl+arrastrar</code>.</li>
</ul>
</li>
<li>Crea una propiedad opcional llamada <code>fechaEdicion</code> de tipo <code>Date</code>, que representará la fecha y hora en que se haya editado el texto. </li>
</ul>
<p>Queremos que cuando haga <em>tap</em> en cualquier parte de la pantalla se acabe la edición del <code>Text View</code>. Para ello podemos añadir el siguiente método al <code>ViewController</code>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">override</span> <span class="kd">func</span> <span class="nf">touchesEnded</span><span class="p">(</span><span class="kc">_</span> <span class="n">touches</span><span class="p">:</span> <span class="n">Set</span><span class="p">&lt;</span><span class="bp">UITouch</span><span class="p">&gt;,</span> <span class="n">with</span><span class="p">:</span> <span class="bp">UIEvent</span><span class="p">?)</span> <span class="p">{</span>
    <span class="c1">//CUIDADO: estamos suponiendo que el outlet del text view se llama &quot;mensaje&quot;</span>
    <span class="c1">//cámbialo por como lo hayas llamado tú</span>
    <span class="kc">self</span><span class="p">.</span><span class="n">mensaje</span><span class="p">.</span><span class="n">resignFirstResponder</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Finalmente, queremos detectar cuándo se ha editado el texto del <code>Text View</code>. Para ello tenemos que hacer que el <em>view controller</em> implemente el protocolo <code>UITextViewDelegate</code>. En la cabecera del <code>ViewController</code> añadimos el protocolo:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">class</span> <span class="nc">ViewController</span> <span class="p">:</span> <span class="bp">UIViewController</span><span class="p">,</span> <span class="bp">UITextViewDelegate</span> <span class="p">{</span>
    <span class="p">...</span>
</pre></div>
</td></tr></table>

<p>Ahora en el mismo <code>ViewController</code> indicamos que este objeto es el <em>delegate</em> del <code>Text View</code>. En el método <code>viewDidLoad</code> añadimos</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">//Cambia &quot;mensaje&quot; por como se llame el outlet del text view</span>
<span class="kc">self</span><span class="p">.</span><span class="n">mensaje</span><span class="p">.</span><span class="n">delegate</span> <span class="p">=</span> <span class="kc">self</span><span class="p">;</span>
</pre></div>
</td></tr></table>

<p>Y finalmente también en el <code>ViewController</code> podemos detectar cuándo se ha hecho la edición implementando este método:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">func</span> <span class="nf">textViewDidEndEditing</span><span class="p">(</span><span class="kc">_</span> <span class="n">textView</span><span class="p">:</span> <span class="bp">UITextView</span><span class="p">)</span> <span class="p">{</span>
    <span class="kc">self</span><span class="p">.</span><span class="n">fechaEdicion</span> <span class="p">=</span> <span class="n">Date</span><span class="p">()</span>
    <span class="c1">//SUPONEMOS que el outlet del label se llama &quot;fechaLabel&quot;</span>
    <span class="c1">//CAMBIALO si es necesario</span>
    <span class="kc">self</span><span class="p">.</span><span class="n">fechaLabel</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="n">DateFormatter</span><span class="p">.</span><span class="n">localizedString</span><span class="p">(</span>
               <span class="n">from</span><span class="p">:</span><span class="kc">self</span><span class="p">.</span><span class="n">fechaEdicion</span><span class="p">!,</span> 
               <span class="n">dateStyle</span><span class="p">:</span> <span class="p">.</span><span class="n">short</span><span class="p">,</span> <span class="n">timeStyle</span><span class="p">:</span> <span class="p">.</span><span class="n">medium</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p><strong>Comprobar que lo anterior funciona correctamente</strong>, que al editar el texto y pulsar sobre la pantalla se dispara el método anterior, y en el <em>label</em> se muestra la fecha y hora de edición.</p>
<h3 id="detectar-que-salimos-de-la-aplicacion-05-puntos">Detectar que salimos de la aplicación (0,5 puntos)<a class="headerlink" href="#detectar-que-salimos-de-la-aplicacion-05-puntos" title="Permanent link">&para;</a></h3>
<p>Lo primero es detectar cuándo salimos de la aplicación para poder hacer el guardado de los datos en ese momento. Para ello podemos suscribirnos a una notificación del sistema llamada <code>UIApplication.didEnterBackgroundNotification</code>.</p>
<p>Introducir el siguiente código en el método <code>viewDidLoad</code> del <em>view controller</em>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nv">nc</span> <span class="p">=</span> <span class="n">NotificationCenter</span><span class="p">.</span><span class="k">default</span>
<span class="n">nc</span><span class="p">.</span><span class="n">addObserver</span><span class="p">(</span><span class="kc">self</span><span class="p">,</span> <span class="n">selector</span><span class="p">:</span><span class="k">#selector</span><span class="p">(</span><span class="kc">self</span><span class="p">.</span><span class="n">vamosABackground</span><span class="p">),</span>
            <span class="n">name</span><span class="p">:</span> <span class="bp">UIApplication</span><span class="p">.</span><span class="n">didEnterBackgroundNotification</span><span class="p">,</span>
            <span class="n">object</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>El código anterior llama al método <code>vamosABackground</code> cuando se recibe la notificación. Para probarlo, podéis hacer una implementación “provisional” del método:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">@objc</span> <span class="kd">func</span> <span class="nf">vamosABackground</span><span class="p">()</span> <span class="p">{</span>
    <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Nos notifican que vamos a background&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Ahora, para probar que esto funciona, hay que arrancar la aplicación y salir de ella como lo haríamos en un dispositivo real, es decir, pulsando sobre el botón <code>Home</code>. También podemos hacerlo en el menú del simulador <code>Hardware &gt; Home</code>, o bien con el atajo de teclado <code>Cmd+Shift+H</code>. Al hacer esto debe aparecer el mensaje en el <em>log</em>. <strong>Comprueba que es así</strong>.</p>
<h3 id="almacenar-los-datos-en-un-archivo-15-puntos">Almacenar los datos en un archivo (1.5 puntos)<a class="headerlink" href="#almacenar-los-datos-en-un-archivo-15-puntos" title="Permanent link">&para;</a></h3>
<p>Aunque en iOS es más típico usar el formato <code>.plist</code> para guardar unos pocos datos, nosotros vamos a hacerlo en JSON. Queremos guardar el texto del mensaje y la fecha de edición (esta última <strong>como una fecha, no como un texto</strong>). Podemos representar ambos valores con un <code>struct</code>. Crea un nuevo tipo <code>struct</code> llamado <code>DatosMensaje</code> con los campos necesarios, puedes guardarlo por ejemplo en un archivo <code>DatosMensaje.swift</code>. Recuerda que para que sea serializable debe declararse como conforme al protocolo <code>Codable</code>.</p>
<p>En el método <code>vamosABackground</code> que hemos creado antes tenemos que hacer esto (puedes tomar como base el código de las transparencias):</p>
<ul>
<li>Obtener la URL del directorio <code>Documents</code> de la aplicación</li>
<li>Crear a partir de ella la URL del fichero <code>mensaje.json</code> donde se guardarán los datos</li>
<li>Instanciar un struct con el texto del mensaje y la fecha de edición</li>
<li>Guardar el archivo <code>.json</code> con un <code>JSONEncoder</code></li>
</ul>
<p><strong>Comprobar</strong> que cuando se sale de la aplicación pulsando el botón <code>Home</code> se ha creado el archivo <code>mensaje.json</code> con el contenido adecuado. Usad la <a href="https://github.com/dsmelov/simsim/releases">aplicación SimSim</a> para ver la carpeta del Mac donde se guarda el <em>sandbox</em> de vuestra <em>app</em>.</p>
<h3 id="recuperar-los-datos-del-archivo-1-puntos">Recuperar los datos del archivo (1 puntos)<a class="headerlink" href="#recuperar-los-datos-del-archivo-1-puntos" title="Permanent link">&para;</a></h3>
<p>Si salimos de la aplicación pulsando el botón <code>Home</code> y volviendo a entrar en ella veremos muy probablemente que se conservan los datos, pero es porque el sistema no ha liberado la memoria. Si quieres estar seguro de que la libere, en el modo en que aparecen todas las <em>apps</em> que se están ejecutando, desliza hacia arriba esta aplicación.</p>
<p>Para recuperar los datos al arrancar la aplicación tenemos que  añadir código al <code>viewDidLoad</code> del <em>view controller</em>: (los dos primeros pasos son los mismos que para guardar los datos)</p>
<ul>
<li>Obtener la URL del directorio <code>Documents</code> de la aplicación </li>
<li>Crear a partir de ella la URL del fichero <code>mensaje.json</code> donde están los datos</li>
<li>Recuperar el <code>struct</code> con el  <code>JSONDecoder</code></li>
</ul>
<p><strong>Comprobar</strong> que cuando paramos el simulador y lo volvemos a poner en marcha se recuperan los datos del <code>.json</code>.</p>
<h2 id="ejercicio-2-preferencias-de-usuario-15-puntos">Ejercicio 2: Preferencias de usuario (1.5 puntos)<a class="headerlink" href="#ejercicio-2-preferencias-de-usuario-15-puntos" title="Permanent link">&para;</a></h2>
<p>Vamos a probar cómo se podría implementar el ejercicio anterior usando preferencias de usuario, aunque no lo implementaremos del todo, solo lo justo para hacer una prueba.</p>
<p>En el método <code>textViewDidEndEditing</code> del <code>ViewController</code> añade el código Swift que necesites para almacenar el texto y la fecha como preferencias llamadas "texto" y "fecha" respectivamente (con la fecha guarda la propiedad de tipo <code>Date</code>, no la fecha convertida a texto). Al salir de la aplicación se debería crear un archivo <code>.plist</code> dentro del <code>Library/Preferences</code> del <em>sandbox</em>. <strong>Usando la <em>app</em> SimSim comprueba</strong> que efectivamente se ha creado este archivo.</p>
<blockquote>
<p>Por defecto el <code>.plist</code> con las preferencias tiene formato binario, así que si lo abres con un editor de texto no verás el contenido pero sí al abrirlo con Xcode</p>
</blockquote>
<p>Finalmente, en el <code>viewDidLoad</code> añade código que recupere las dos preferencias y las imprima con <code>print</code> (no tiene sentido que las ponga en los <em>outlets</em> ya que eso ya lo hacíamos en el ejercicio anterior). Para recuperar la fecha tendrás que usar el método <code>object</code> de <code>UserDefaults</code>.</p>
<blockquote>
<p>Fíjate que la ventaja de las preferencias sobre el JSON es que no necesitamos serializar/deserializar explícitamente los datos. A cambio perdemos el control sobre algunos aspectos como el formato de los datos o el momento exacto en que se guardan.</p>
</blockquote>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../1.4_preferencias/" title="Preferencias" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Anterior
                </span>
                Preferencias
              </span>
            </div>
          </a>
        
        
          <a href="../../cap2/2.1_intro_SQLite/" title="Introducción" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Siguiente
                </span>
                Introducción
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>